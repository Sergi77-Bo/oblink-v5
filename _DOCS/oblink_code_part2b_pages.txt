--- PART 2b: PAGES (N-Z) ---
--- FILE: theme/page-recherche-opticiens.php ---
<?php
/*
Template Name: Recherche Opticiens
*/

include 'header-inc.php';
?>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

<!-- Nav is handled by header.php -->

<!-- Header (Compact) -->
<div class="bg-gradient-to-r from-oblink-blue to-oblink-violet text-white pt-32 pb-8">
    <div class="max-w-7xl mx-auto px-4">
        <h1 class="text-3xl font-bold mb-2">Trouvez un opticien</h1>
        <p class="opacity-90">Explorez la carte pour trouver les meilleurs talents disponibles.</p>
    </div>
</div>

<!-- Map & Filters Layout -->
<div class="h-[calc(100vh-200px)] flex flex-col md:flex-row">

    <!-- Sidebar / List (30% width) -->
    <div class="w-full md:w-1/3 bg-white border-r border-gray-200 flex flex-col z-20 shadow-xl">

        <!-- Filters -->
        <div class="p-4 border-b border-gray-100 bg-gray-50">
            <div class="relative">
                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                <input type="text" id="filter-search" placeholder="Ville, Nom..."
                    class="w-full pl-10 pr-4 py-2 rounded-lg border-gray-200 focus:ring-oblink-blue focus:border-oblink-blue text-sm">
            </div>

            <div class="flex gap-2 mt-2">
                <select id="filter-availability" class="flex-1 text-sm border-gray-200 rounded-lg py-2">
                    <option value="">Tous statuts</option>
                    <option value="available">Disponible</option>
                </select>
                <!-- Add more filters here later -->
            </div>
        </div>

        <!-- Results List -->
        <div class="flex-1 overflow-y-auto p-4 space-y-4" id="opticians-list">
            <!-- Loading State -->
            <div class="text-center py-8 text-gray-400">
                <i class="fas fa-circle-notch fa-spin mb-2"></i>
                <p class="text-xs">Chargement des opticiens...</p>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="p-3 border-t border-gray-100 text-xs text-gray-500 flex justify-between bg-gray-50">
            <span id="result-count">0 opticiens trouv√©s</span>
            <span>France</span>
        </div>
    </div>

    <!-- Map Container (70% width) -->
    <div class="flex-1 relative bg-gray-100 z-10">
        <div id="map" class="absolute inset-0 w-full h-full"></div>

        <!-- Map Overlay Controls -->
        <div class="absolute top-4 right-4 z-[400] bg-white rounded-lg shadow-md p-2">
            <button id="locate-me-btn"
                class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-oblink-blue"
                title="Ma position">
                <i class="fas fa-location-arrow"></i>
            </button>
        </div>
    </div>

</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script>
    document.addEventListener('DOMContentLoaded', async () => {

        // 1. Initialize Map
        const map = L.map('map').setView([46.603354, 1.888334], 6); // Centered on France

        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        const markersLayer = L.layerGroup().addTo(map);
        let allOpticians = [];

        // 2. Fetch Opticians from Supabase
        async function fetchOpticians() {
            try {
                // Fetch profiles where user_type is opticien
                // Note: We should filter by latitude not null ideally, but client-side filter is fine for MVP size
                const { data: opticians, error } = await window.oblinkSupabase
                    .from('profiles')
                    .select('*')
                    .eq('user_type', 'opticien');

                if (error) throw error;

                // Filter out those without coordinates
                allOpticians = opticians.filter(opt => opt.latitude && opt.longitude);

                updateDisplay(allOpticians);

            } catch (err) {
                console.error("Error loading opticians:", err);
                document.getElementById('opticians-list').innerHTML = '<div class="text-red-500 p-4 text-center">Erreur de chargement des donn√©es.</div>';
            }
        }

        // 3. Render Markers & List
        function updateDisplay(opticians) {
            // Clear existing
            markersLayer.clearLayers();
            const listContainer = document.getElementById('opticians-list');
            listContainer.innerHTML = '';

            document.getElementById('result-count').textContent = `${opticians.length} opticiens g√©olocalis√©s`;

            if (opticians.length === 0) {
                listContainer.innerHTML = `
                    <div class="text-center py-10 px-4">
                        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl">üåç</div>
                        <h3 class="font-bold text-gray-500">Aucun opticien sur la carte</h3>
                        <p class="text-xs text-gray-400 mt-2">Invitez des opticiens √† mettre √† jour leur localisation dans "Param√®tres".</p>
                    </div>
                `;
                return;
            }

            // Loop
            opticians.forEach(opt => {
                // Add Marker
                const customIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: `<div class="w-8 h-8 rounded-full bg-oblink-blue border-2 border-white shadow-lg flex items-center justify-center text-white font-bold text-xs">${opt.first_name ? opt.first_name.charAt(0) : 'O'}</div>`,
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });

                const marker = L.marker([opt.latitude, opt.longitude], { icon: customIcon })
                    .on('click', () => {
                        // Highlight list item
                        document.querySelectorAll('.optician-item').forEach(el => el.classList.remove('ring-2', 'ring-oblink-blue'));
                        const listItem = document.getElementById(`opt-${opt.id}`);
                        if (listItem) {
                            listItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            listItem.classList.add('ring-2', 'ring-oblink-blue');
                        }
                    })
                    .bindPopup(`
                        <div class="text-center">
                            <h3 class="font-bold text-gray-800">${escapeHtml(opt.first_name)} ${escapeHtml(opt.last_name)}</h3>
                            <p class="text-xs text-gray-500 mb-2">${escapeHtml(opt.city || '')}</p>
                            <a href="<?php echo home_url('/profil-opticien'); ?>?id=${opt.id}" class="block text-xs bg-oblink-blue text-white px-2 py-1 rounded hover:bg-blue-600">Voir profil</a>
                        </div>
                    `);

                markersLayer.addLayer(marker);

                // Add List Item
                const card = document.createElement('div');
                card.id = `opt-${opt.id}`;
                card.className = "optician-item bg-white p-3 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition cursor-pointer flex gap-3";
                card.innerHTML = `
                    <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 font-bold flex-shrink-0">
                        ${opt.first_name ? opt.first_name.charAt(0) : 'O'}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex justify-between items-start">
                            <h4 class="font-bold text-sm text-gray-800 truncate">${escapeHtml(opt.first_name)} ${escapeHtml(opt.last_name)}</h4>
                            <span class="text-[10px] bg-green-100 text-green-700 px-1.5 py-0.5 rounded">Dispo</span>
                        </div>
                        <p class="text-xs text-gray-500 truncate"><i class="fas fa-map-marker-alt text-oblink-orange/70 mr-1"></i> ${escapeHtml(opt.city || 'Ville inconnue')}</p>
                        <p class="text-xs text-gray-400 mt-1 line-clamp-1">${escapeHtml(opt.bio_short || 'Aucune bio.')}</p>
                    </div>
                `;

                // Card Click -> Zoom Map
                card.addEventListener('click', () => {
                    map.flyTo([opt.latitude, opt.longitude], 12);
                    marker.openPopup();
                });

                listContainer.appendChild(card);
            });
        }

        // Security Helper
        function escapeHtml(text) {
            if (!text) return '';
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Locate Me Button
        document.getElementById('locate-me-btn').addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    map.setView([lat, lon], 12);
                    // Could add a "You are here" marker
                });
            } else {
                alert("La g√©olocalisation n'est pas support√©e par votre navigateur.");
            }
        });

        // Search Filter (Basic Client-Side)
        document.getElementById('filter-search').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = allOpticians.filter(opt => {
                const name = (opt.first_name + ' ' + opt.last_name).toLowerCase();
                const city = (opt.city || '').toLowerCase();
                return name.includes(term) || city.includes(term);
            });
            updateDisplay(filtered);
        });

        // Availability Filter (FIXED - was missing event listener)
        document.getElementById('filter-availability').addEventListener('change', (e) => {
            const statusValue = e.target.value;
            const searchTerm = document.getElementById('filter-search').value.toLowerCase();

            let filtered = allOpticians;

            // Apply search term if exists
            if (searchTerm) {
                filtered = filtered.filter(opt => {
                    const name = (opt.first_name + ' ' + opt.last_name).toLowerCase();
                    const city = (opt.city || '').toLowerCase();
                    return name.includes(searchTerm) || city.includes(searchTerm);
                });
            }

            //  Apply availability filter
            if (statusValue === 'available') {
                // Assuming profiles have an `availability_status` or similar field
                // If not, you'll need to add this field to the profiles table
                filtered = filtered.filter(opt => opt.availability_status === 'available');
            }

            updateDisplay(filtered);
        });

        // Init
        fetchOpticians();

    });
</script>

<?php
// No footer content for the map view to maximize space, just scripts
wp_footer();
?>--- FILE: theme/page-verify-cert.php ---
<?php
/*
Template Name: OBLINK Certificate Verification
*/

// Security: Retrieve Param from URL
$cert_id = get_query_var('cert_id', 'CERT-OB-2026-88X42'); // Fallback for demo
$student_name = "Thomas R."; // Mock data for V1
$score = 92;
$date = date('d/m/Y', strtotime('-2 days'));

?>
<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow"> <!-- SEO Request -->
    <title>V√©rification Certificat - <?php echo $cert_id; ?></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- 1. Header Banner -->
    <div class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-3xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div
                    class="w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-blue-600 flex items-center justify-center text-white font-bold text-xs">
                    OB</div>
                <span class="font-bold text-gray-900 tracking-tight">OBLINK <span
                        class="text-gray-400 font-normal">Check</span></span>
            </div>
            <div
                class="flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full text-xs font-bold border border-green-100">
                <i class="fas fa-check-circle"></i> PROFIL V√âRIFI√â
            </div>
        </div>
    </div>

    <main class="flex-grow p-4 md:p-8">
        <div class="max-w-2xl mx-auto space-y-6">

            <!-- 2. Certificate Status Card -->
            <div class="bg-white rounded-2xl shadow-sm border border-green-200 overflow-hidden relative">
                <div class="h-2 bg-gradient-to-r from-green-500 to-teal-500 w-full"></div>
                <div class="p-6 md:p-8 text-center">
                    <div
                        class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-4xl mx-auto mb-4 border-4 border-white shadow-sm ring-4 ring-green-50">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <h1 class="text-2xl md:text-3xl font-black text-gray-900 mb-2">Statut Expert Confirm√©</h1>
                    <p class="text-gray-500 font-mono text-sm bg-gray-100 inline-block px-3 py-1 rounded mb-4">ADELI: 75
                        92 **** 4</p>
                    <p class="text-gray-600 text-sm">Ce professionnel a pass√© avec succ√®s notre protocole de
                        v√©rification hybride.</p>
                </div>
            </div>

            <!-- 3. Candidate Identity & Protocols -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
                <div class="flex flex-col md:flex-row items-center gap-6 mb-8 text-center md:text-left">
                    <div class="relative">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Candidate"
                            class="w-24 h-24 rounded-full border-4 border-white shadow-lg">
                        <div class="absolute bottom-0 right-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm border-2 border-white shadow-sm"
                            title="Identit√© V√©rifi√©e">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900"><?php echo $student_name; ?></h2>
                        <div class="flex flex-wrap gap-2 justify-center md:justify-start mt-2">
                            <span
                                class="inline-flex items-center bg-blue-50 text-blue-700 text-xs font-bold px-2 py-1 rounded border border-blue-100">
                                <i class="fas fa-file-medical mr-1"></i> ADELI V√©rifi√©
                            </span>
                            <span
                                class="inline-flex items-center bg-purple-50 text-purple-700 text-xs font-bold px-2 py-1 rounded border border-purple-100">
                                <i class="fab fa-stripe mr-1"></i> ID Stripe (KYC)
                            </span>
                        </div>
                    </div>
                </div>

                <div class="border-t border-gray-100 pt-6">
                    <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-4">Protocole de S√©curit√©
                        Hybride</h3>
                    <div class="grid gap-4">
                        <!-- Step 1 -->
                        <div class="flex items-start gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center shrink-0 mt-1">
                                <i class="fas fa-check font-bold text-sm"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 text-sm">V√©rification L√©gale (ADELI)</h4>
                                <p class="text-xs text-gray-500">Num√©ro ADELI correspondant √† l'identit√©, valid√© aupr√®s
                                    de l'Annuaire Sant√© National.</p>
                            </div>
                        </div>
                        <!-- Step 2 -->
                        <div class="flex items-start gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center shrink-0 mt-1">
                                <i class="fas fa-check font-bold text-sm"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 text-sm">V√©rification d'Identit√© Bancaire (KYC)</h4>
                                <p class="text-xs text-gray-500">Identit√© physique valid√©e par Stripe Connect
                                    (Partenaire Paiement S√©curis√©).</p>
                            </div>
                        </div>
                        <!-- Step 3 -->
                        <div class="flex items-start gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center shrink-0 mt-1">
                                <i class="fas fa-check font-bold text-sm"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 text-sm">Validation Technique (Acad√©mie OBLINK)</h4>
                                <p class="text-xs text-gray-500">Score de <?php echo $score; ?>% obtenu sur le module
                                    "Cosium Expert" le <?php echo $date; ?>.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. Recruiter CTA -->
            <div
                class="bg-gradient-to-r from-gray-900 to-gray-800 rounded-2xl shadow-xl p-6 md:p-8 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="font-bold text-xl mb-2">Profil S√©curis√© & Valid√©</h3>
                    <p class="text-gray-300 text-sm mb-6">Avec OBLINK, vous ne recrutez pas seulement un CV, mais une
                        comp√©tence technique v√©rifi√©e et une identit√© certifi√©e.</p>

                    <div class="flex flex-col sm:flex-row gap-3">
                        <button
                            class="bg-oblink-orange hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg transition shadow-lg flex-1 text-center bg-orange-500">
                            <i class="fas fa-handshake mr-2"></i> Proposer une mission
                        </button>
                    </div>
                </div>
                <!-- Decor -->
                <div
                    class="absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none">
                </div>
            </div>

            <!-- Conditions Section (New) -->
            <div class="text-center">
                <a href="#" class="text-xs text-gray-400 hover:text-gray-600 underline">Voir les conditions d'acc√®s au
                    statut Expert</a>
            </div>

        </div>
    </main>

    <footer class="text-center py-6 text-xs text-gray-400">
        &copy; <?php echo date('Y'); ?> OBLINK. Tous droits r√©serv√©s.
    </footer>

</body>

</html>--- FILE: theme/page-pass-examen.php ---
<?php
/*
Template Name: Pass Examen BTS
*/
include 'header-inc.php';
?>

<div class="bg-white font-sans text-gray-900">

    <!-- HERO SECTION -->
    <div class="relative overflow-hidden bg-gray-900 text-white border-b border-gray-800">
        <div
            class="absolute inset-0 bg-[url('<?php echo get_template_directory_uri(); ?>/images/grid-pattern.png')] opacity-10">
        </div>
        <div
            class="absolute top-0 right-0 w-[500px] h-[500px] bg-oblink-orange/20 rounded-full blur-[120px] pointer-events-none transform translate-x-1/2 -translate-y-1/2">
        </div>
        <div
            class="absolute bottom-0 left-0 w-[300px] h-[300px] bg-oblink-violet/20 rounded-full blur-[100px] pointer-events-none transform -translate-x-1/3 translate-y-1/3">
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-20 relative z-10">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div>
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 text-oblink-orange font-bold text-xs mb-6 border border-white/10 uppercase tracking-wider">
                        <i class="fas fa-crown"></i> Nouveau ‚Ä¢ BTS Opticien Lunetier
                    </div>
                    <h1 class="text-4xl md:text-6xl font-black font-display leading-[1.1] mb-6">
                        Ne laissez pas le hasard d√©cider de <span
                            class="text-transparent bg-clip-text bg-gradient-to-r from-oblink-orange to-oblink-violet">votre
                            dipl√¥me</span>.
                    </h1>
                    <p class="text-lg text-gray-400 mb-8 leading-relaxed max-w-lg">
                        Acc√©dez √† 27 ans d'annales corrig√©es et laissez notre IA analyser vos points faibles. Le seul
                        outil de r√©vision qui s'adapte √† vous.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <a href="#pricing"
                            class="inline-flex justify-center items-center px-8 py-4 text-base font-bold text-white bg-oblink-orange rounded-xl hover:bg-orange-600 transition shadow-lg hover:shadow-orange-500/25 transform hover:-translate-y-1">
                            Obtenir mon Pass Examen
                        </a>
                        <a href="#demo"
                            class="inline-flex justify-center items-center px-8 py-4 text-base font-bold text-white bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition backdrop-blur-sm">
                            <i class="fas fa-play mr-2 text-oblink-orange"></i> Voir la d√©mo
                        </a>
                    </div>
                    <div class="mt-8 flex items-center gap-4 text-sm text-gray-500">
                        <div class="flex -space-x-2">
                            <img class="w-8 h-8 rounded-full border-2 border-gray-900"
                                src="https://randomuser.me/api/portraits/thumb/men/1.jpg" alt="">
                            <img class="w-8 h-8 rounded-full border-2 border-gray-900"
                                src="https://randomuser.me/api/portraits/thumb/women/2.jpg" alt="">
                            <img class="w-8 h-8 rounded-full border-2 border-gray-900"
                                src="https://randomuser.me/api/portraits/thumb/men/3.jpg" alt="">
                        </div>
                        <p>Rejoint par <span class="text-white font-bold">2,140+ √©tudiants</span> cette ann√©e</p>
                    </div>
                </div>
                <div class="relative lg:h-[600px] flex items-center justify-center">
                    <!-- Conceptuel UI Mockup -->
                    <div
                        class="relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-800 rotate-[-2deg] hover:rotate-0 transition duration-700">
                        <div class="bg-gray-100 p-3 border-b border-gray-200 flex gap-2">
                            <div class="w-3 h-3 rounded-full bg-red-400"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                            <div class="w-3 h-3 rounded-full bg-green-400"></div>
                        </div>
                        <div class="p-6 bg-white">
                            <div class="flex items-center gap-3 mb-6">
                                <div
                                    class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-900">Analyse de la Vision</h4>
                                    <p class="text-xs text-gray-500">Sujet 2024 ‚Ä¢ Note estim√©e: 14/20</p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
                                    <p class="text-xs font-bold text-gray-400 uppercase mb-2">Question IA</p>
                                    <p class="text-sm font-semibold text-gray-800 mb-2">D√©crivez le trajet des rayons
                                        lumineux dans un ≈ìil hyperm√©trope non corrig√©.</p>
                                    <div class="h-2 w-3/4 bg-gray-200 rounded animate-pulse"></div>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                                    <p class="text-xs font-bold text-blue-400 uppercase mb-2">Correction Instantan√©e</p>
                                    <p class="text-sm text-gray-700">Dans un ≈ìil hyperm√©trope au repos, l'image d'un
                                        objet √† l'infini se forme <strong>en arri√®re de la r√©tine</strong>. Le Punctum
                                        Remotum est virtuel, situ√© derri√®re l'≈ìil.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Floating Widget -->
                    <div
                        class="absolute bottom-12 -right-4 bg-white p-4 rounded-xl shadow-xl border border-gray-100 max-w-xs transform translate-y-4 animate-bounce-slow">
                        <div class="flex items-center gap-3">
                            <div
                                class="w-10 h-10 bg-oblink-orange rounded-full flex items-center justify-center text-white">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-gray-900">138 Annales incluses</p>
                                <p class="text-xs text-green-600 font-semibold">T√©l√©chargement imm√©diat</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- VALUE PROPOSITION -->
    <div class="py-24 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl md:text-4xl font-black text-gray-900 font-display mb-4">Pourquoi payer pour ce que
                    vous pouvez trouver gratuitement ?</h2>
                <p class="text-lg text-gray-500">Parce que vous n'achetez pas de l'information. Vous achetez du temps,
                    de la structure et une correction personnalis√©e impossible √† obtenir seul.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Feature 1 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-lg transition-all group">
                    <div
                        class="w-14 h-14 rounded-2xl bg-orange-100 text-oblink-orange flex items-center justify-center text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Diagnostic IA Personnalis√©</h3>
                    <p class="text-gray-500 leading-relaxed">Fini de r√©viser ce que vous savez d√©j√†. Notre IA identifie
                        vos lacunes pr√©cises en 5 minutes et cr√©e un plan de r√©vision sur mesure.</p>
                </div>

                <!-- Feature 2 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-lg transition-all group">
                    <div
                        class="w-14 h-14 rounded-2xl bg-blue-100 text-oblink-blue flex items-center justify-center text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">27 Ans d'Archives</h3>
                    <p class="text-gray-500 leading-relaxed">Acc√©dez √† la plus grande base de donn√©es d'annales
                        (1999-2025). Sujets et corrig√©s officiels, class√©s et analys√©s.</p>
                </div>

                <!-- Feature 3 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-lg transition-all group">
                    <div
                        class="w-14 h-14 rounded-2xl bg-purple-100 text-purple-600 flex items-center justify-center text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Simulateur d'Examen</h3>
                    <p class="text-gray-500 leading-relaxed">Posez n'importe quelle question sur un sujet. L'IA vous
                        r√©pond comme un correcteur d'examen, avec les attendus officiels.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- PRICING SECTION -->
    <div id="pricing" class="py-24 bg-white relative overflow-hidden">
        <div class="absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent"></div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:grid lg:grid-cols-12 gap-12 items-center">
                <div class="lg:col-span-5 mb-12 lg:mb-0">
                    <h2 class="text-3xl md:text-5xl font-black text-gray-900 font-display mb-6">Investissez sur votre
                        r√©ussite.</h2>
                    <p class="text-lg text-gray-500 mb-8">Un tuteur priv√© co√ªte 50‚Ç¨/heure. OBLINK Acad√©mie vous offre un
                        acc√®s illimit√© √† l'intelligence de 27 ans d'examens pour le prix d'un seul repas.</p>

                    <div class="space-y-4">
                        <div class="flex items-center gap-3 text-gray-700">
                            <i class="fas fa-check text-green-500"></i> <span>Paiement unique, acc√®s √† vie</span>
                        </div>
                        <div class="flex items-center gap-3 text-gray-700">
                            <i class="fas fa-check text-green-500"></i> <span>Satisfait ou rembours√© (14j)</span>
                        </div>
                        <div class="flex items-center gap-3 text-gray-700">
                            <i class="fas fa-check text-green-500"></i> <span>Support technique 7j/7</span>
                        </div>
                    </div>
                </div>

                <div class="lg:col-span-7">
                    <div class="relative bg-gray-900 rounded-3xl p-1 shadow-2xl">
                        <div
                            class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-oblink-orange text-white px-6 py-1 rounded-full text-sm font-bold uppercase tracking-wide shadow-lg">
                            Offre de Lancement
                        </div>
                        <div class="bg-gray-800 rounded-[22px] p-8 md:p-12">
                            <div
                                class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 pb-8 border-b border-gray-700">
                                <div>
                                    <h3 class="text-2xl font-bold text-white mb-2">Pass Examen BTS OL</h3>
                                    <p class="text-gray-400 text-sm">Acc√®s Illimit√© 6 mois ‚Äî Rentabilis√© d√®s la 1√®re
                                        heure</p>
                                </div>
                                <div class="mt-4 md:mt-0 text-right">
                                    <div class="text-sm text-gray-400 line-through">99,00 ‚Ç¨</div>
                                    <div class="text-4xl font-black text-white">29,00 ‚Ç¨</div>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-y-4 gap-x-8 mb-8">
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> 138 Annales (1999-2025)
                                </li>
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> Analyse de Vision & OGP
                                </li>
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> Corrig√©s D√©taill√©s
                                </li>
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> Assistant IA Illimit√©
                                </li>
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> Fiches R√©vision NotebookLM
                                </li>
                                <li class="flex items-center gap-3 text-gray-300">
                                    <i class="fas fa-check-circle text-oblink-orange"></i> Quiz Interactifs
                                </li>
                            </div>

                            <div class="mb-6 bg-gray-700/50 p-4 rounded-xl border border-gray-600">
                                <label class="flex items-start gap-3 cursor-pointer group">
                                    <div class="relative flex items-center">
                                        <input type="checkbox" id="cgu-consent"
                                            class="peer h-5 w-5 cursor-pointer appearance-none rounded border border-gray-500 bg-gray-800 transition-all checked:border-oblink-orange checked:bg-oblink-orange hover:border-oblink-orange" />
                                        <div
                                            class="pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-white opacity-0 peer-checked:opacity-100">
                                            <i class="fas fa-check text-xs"></i>
                                        </div>
                                    </div>
                                    <span class="text-sm text-gray-300 select-none group-hover:text-white transition">
                                        J'accepte les <a href="<?php echo home_url('/cgu#academie-conditions'); ?>"
                                            target="_blank"
                                            class="text-oblink-orange underline hover:text-orange-400">CGU</a> et je
                                        reconnais qu'en acc√©dant imm√©diatement au contenu num√©rique, <strong>je renonce
                                            √† mon droit de r√©tractation</strong>.
                                    </span>
                                </label>
                            </div>

                            <button
                                onclick="if(!document.getElementById('cgu-consent').checked) { alert('Veuillez accepter les conditions (renoncement au droit de r√©tractation) pour acc√©der au contenu imm√©diat.'); return; } alert('Redirection vers Stripe... (Module en cours d\'int√©gration)')"
                                class="w-full py-5 bg-white text-gray-900 font-black rounded-xl hover:bg-oblink-orange hover:text-white transition-all transform hover:scale-[1.02] shadow-xl text-lg flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed">
                                <span>D√©bloquer mon acc√®s maintenant</span>
                                <i class="fas fa-arrow-right"></i>
                            </button>
                            <p class="text-center text-gray-500 text-xs mt-4">Paiement s√©curis√© par Stripe ‚Ä¢ Facture
                                disponible</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FAQ SECTION -->
    <div class="py-24 bg-gray-50">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-black text-center text-gray-900 mb-12">Questions Fr√©quentes</h2>

            <div class="space-y-4">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-900 mb-2">Est-ce que cela couvre toutes les mati√®res ?</h3>
                    <p class="text-gray-500">Nous nous concentrons principalement sur les mati√®res techniques √† fort
                        coefficient : Analyse de la Vision, Optique G√©om√©trique et Physique, et √âtude Technique. Les
                        maths et la gestion sont inclus en bonus.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-900 mb-2">Comment fonctionne l'IA ?</h3>
                    <p class="text-gray-500">Notre IA est entra√Æn√©e sur 27 ans d'annales officielles. Elle ne fait pas
                        qu'inventer des r√©ponses, elle restructure les connaissances officielles pour qu'elles soient
                        p√©dagogiques et faciles √† retenir.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-900 mb-2">Puis-je l'utiliser sur mon t√©l√©phone ?</h3>
                    <p class="text-gray-500">Absolument. OBLINK Acad√©mie est une web-app optimis√©e pour mobile. R√©visez
                        dans le bus, entre deux cours ou au lit.</p>
                </div>
            </div>
        </div>
    </div>

</div>

<?php
include get_template_directory() . "/footer-content.php";
wp_footer();
?>--- FILE: theme/page-pour-opticiens.php ---
<?php
/*
Template Name: Pour Opticiens
*/
include 'header-inc.php';
?>

<div class="min-h-screen bg-white">

    <!-- Hero Section -->
    <div class="pt-32 pb-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <div class="text-center max-w-4xl mx-auto">
            <span
                class="inline-block py-1 px-3 rounded-full bg-oblink-orange/10 text-oblink-orange font-bold text-sm mb-6 uppercase tracking-wider">
                Pour les Opticiens & optom√©tristes
            </span>
            <h1 class="text-5xl md:text-7xl font-black font-display text-oblink-gray mb-8 leading-tight">
                Votre carri√®re, <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-oblink-orange to-oblink-violet">vos
                    r√®gles.</span>
            </h1>
            <p class="text-xl text-gray-500 mb-10 max-w-2xl mx-auto font-light leading-relaxed">
                Reprenez le contr√¥le de votre temps et de vos revenus. Devenez freelance et doublez votre salaire en
                choisissant vos missions.
            </p>

            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <a href="<?php echo home_url('/inscription-opticien'); ?>"
                    class="px-8 py-4 bg-oblink-orange text-white font-bold rounded-xl shadow-lg hover:shadow-orange-500/30 hover:-translate-y-1 transition text-lg">
                    Devenir Freelance
                </a>
                <a href="<?php echo home_url('/simulateur'); ?>"
                    class="px-8 py-4 bg-gray-100 text-oblink-gray font-bold rounded-xl hover:bg-gray-200 transition text-lg flex items-center justify-center gap-2">
                    <i class="fas fa-calculator text-oblink-orange"></i> Simuler mes revenus
                </a>
            </div>
        </div>
    </div>

    <!-- Benefits Grid -->
    <div class="bg-gray-50 py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <!-- Card 1 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-orange-100 flex items-center justify-center text-oblink-orange text-2xl mb-6">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">Libert√© Totale</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Choisissez vos jours, vos horaires et vos zones g√©ographiques. Vous √™tes seul ma√Ætre de votre
                        emploi du temps.
                    </p>
                </div>

                <!-- Card 2 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-blue-100 flex items-center justify-center text-oblink-blue text-2xl mb-6">
                        <i class="fas fa-euro-sign"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">Revenus Boost√©s</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Fixez votre TJM (Taux Journalier) sans interm√©diaire. En moyenne, nos freelances gagnent 30% de
                        plus qu'en salariat.
                    </p>
                </div>

                <!-- Card 3 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-purple-100 flex items-center justify-center text-oblink-violet text-2xl mb-6">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">Z√©ro Administratif</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Contrats, factures, relances... OBLINK g√®re tout pour vous avec son <a
                            href="<?php echo home_url('/generateur-contrat'); ?>"
                            class="text-oblink-blue underline">outil d√©di√©</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Profils Recherch√©s Section -->
    <div class="py-20 px-4 bg-white">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-black font-display text-oblink-gray mb-6">
                    Tous les profils de l'optique
                </h2>
                <p class="text-xl text-gray-500 max-w-3xl mx-auto">
                    Notre plateforme accueille <strong>tous les professionnels</strong> du secteur optique,
                    quel que soit votre m√©tier ou votre statut.
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Colonne 1: En Magasin -->
                <div class="bg-orange-50 rounded-2xl p-6">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 bg-oblink-orange rounded-xl flex items-center justify-center text-white">
                            <i class="fas fa-store"></i>
                        </div>
                        <h3 class="text-xl font-bold text-oblink-gray">En Magasin</h3>
                    </div>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Opticien collaborateur</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Opticien rempla√ßant</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Opticien en alternance</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Vendeur optique</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Monteur-vendeur</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Conseiller solaires</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Audioproth√©siste</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Assistant audioproth√©siste</li>
                        <li><i class="fas fa-check text-oblink-orange mr-2"></i>Adaptateur lentilles</li>
                    </ul>
                </div>

                <!-- Colonne 2: Nomades / Terrain -->
                <div class="bg-blue-50 rounded-2xl p-6">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 bg-oblink-blue rounded-xl flex items-center justify-center text-white">
                            <i class="fas fa-road"></i>
                        </div>
                        <h3 class="text-xl font-bold text-oblink-gray">Nomades</h3>
                    </div>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li><i class="fas fa-check text-oblink-blue mr-2"></i>Opticien √† domicile</li>
                        <li><i class="fas fa-check text-oblink-blue mr-2"></i>Agent VRP</li>
                        <li><i class="fas fa-check text-oblink-blue mr-2"></i>Commercial secteur</li>
                        <li><i class="fas fa-check text-oblink-blue mr-2"></i>Animateur r√©seau</li>
                        <li><i class="fas fa-check text-oblink-blue mr-2"></i>Responsable de secteur</li>
                    </ul>
                </div>

                <!-- Colonne 3: Experts / Management -->
                <div class="bg-purple-50 rounded-2xl p-6">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 bg-oblink-violet rounded-xl flex items-center justify-center text-white">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="text-xl font-bold text-oblink-gray">Experts</h3>
                    </div>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Opticien directeur</li>
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Responsable technique</li>
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Optom√©triste</li>
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Opticien tiers payant</li>
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Directeur des ventes</li>
                        <li><i class="fas fa-check text-oblink-violet mr-2"></i>Chef de produits</li>
                    </ul>
                </div>

                <!-- Colonne 4: Autres Professions -->
                <div class="bg-gray-100 rounded-2xl p-6">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 bg-oblink-gray rounded-xl flex items-center justify-center text-white">
                            <i class="fas fa-ellipsis-h"></i>
                        </div>
                        <h3 class="text-xl font-bold text-oblink-gray">Autres</h3>
                    </div>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li><i class="fas fa-check text-oblink-gray mr-2"></i>Orthoptiste</li>
                        <li><i class="fas fa-check text-oblink-gray mr-2"></i>AMO (Assistant m√©dical)</li>
                        <li><i class="fas fa-check text-oblink-gray mr-2"></i>Enseignant optique</li>
                        <li><i class="fas fa-check text-oblink-gray mr-2"></i>... et bien d'autres !</li>
                    </ul>
                </div>
            </div>

            <div class="text-center mt-12">
                <p class="text-gray-500 text-lg">
                    Vous ne trouvez pas votre profil ? <a href="<?php echo home_url('/inscription-opticien'); ?>"
                        class="text-oblink-orange font-bold hover:underline">Inscrivez-vous quand m√™me !</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Call to Action -->
    <div class="py-20 px-4">
        <div
            class="max-w-5xl mx-auto bg-oblink-gray rounded-3xl p-8 md:p-16 text-center transform hover:scale-[1.01] transition duration-500 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-10">
                <div class="absolute right-0 top-0 w-64 h-64 bg-oblink-orange rounded-full blur-3xl"></div>
                <div class="absolute left-0 bottom-0 w-64 h-64 bg-oblink-blue rounded-full blur-3xl"></div>
            </div>

            <div class="relative z-10">
                <h2 class="text-3xl md:text-5xl font-black font-display text-white mb-6">
                    Pr√™t √† changer de vie ?
                </h2>
                <p class="text-xl text-gray-400 mb-10 max-w-2xl mx-auto font-light">
                    Rejoignez les 500+ opticiens qui ont d√©j√† franchi le pas. Lancez-vous sans risque.
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <a href="<?php echo home_url('/inscription-opticien'); ?>"
                        class="px-8 py-4 bg-gradient-to-r from-oblink-orange to-oblink-violet text-white font-bold rounded-xl shadow-lg hover:shadow-orange-500/30 hover:-translate-y-1 transition text-lg">
                        Cr√©er mon compte Freelance
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- GLOBAL HARDCODED FOOTER REUSE -->
<div class="footer-wrapper">
    <?php include get_template_directory() . '/footer-content.php'; ?>
</div>
<?php wp_footer(); ?>
</body>

</html>--- FILE: theme/page-pour-entreprises.php ---
<?php
/*
Template Name: Pour Entreprises
*/
include 'header-inc.php';
?>

<div class="min-h-screen bg-white">

    <!-- Hero Section -->
    <div class="pt-32 pb-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <div class="text-center max-w-4xl mx-auto">
            <span
                class="inline-block py-1 px-3 rounded-full bg-oblink-blue/10 text-oblink-blue font-bold text-sm mb-6 uppercase tracking-wider">
                Pour les Magasins & Enseignes
            </span>
            <h1 class="text-5xl md:text-7xl font-black font-display text-oblink-gray mb-8 leading-tight">
                Recrutez un opticien <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-oblink-blue to-oblink-violet">en 24
                    heures.</span>
            </h1>
            <p class="text-xl text-gray-500 mb-10 max-w-2xl mx-auto font-light leading-relaxed">
                Acc√©dez √† la plus grande base de freelances qualifi√©s et disponibles imm√©diatement. Fini les fermetures
                de magasin par manque de personnel.
            </p>

            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <a href="<?php echo home_url('/inscription-entreprise'); ?>"
                    class="px-8 py-4 bg-oblink-blue text-white font-bold rounded-xl shadow-lg hover:shadow-blue-500/30 hover:-translate-y-1 transition text-lg">
                    Publier une mission
                </a>
                <a href="<?php echo home_url('/recherche-opticiens'); ?>"
                    class="px-8 py-4 bg-gray-100 text-oblink-gray font-bold rounded-xl hover:bg-gray-200 transition text-lg flex items-center justify-center gap-2">
                    <i class="fas fa-search text-oblink-blue"></i> Consulter les CVs
                </a>
            </div>
        </div>
    </div>

    <!-- Benefits Grid -->
    <div class="bg-gray-50 py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <!-- Card 1 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-blue-100 flex items-center justify-center text-oblink-blue text-2xl mb-6">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">R√©activit√© Imm√©diate</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Un arr√™t maladie impr√©vu ? Trouvez un rempla√ßant op√©rationnel pour le lendemain matin. Nos
                        freelances sont notifi√©s en temps r√©el.
                    </p>
                </div>

                <!-- Card 2 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-purple-100 flex items-center justify-center text-oblink-violet text-2xl mb-6">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">Profils V√©rifi√©s</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Dipl√¥mes et identit√© contr√¥l√©s. Vous recrutez des professionnels de confiance, √©valu√©s par la
                        communaut√©.
                    </p>
                </div>

                <!-- Card 3 -->
                <div
                    class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 hover:shadow-xl transition hover:-translate-y-1">
                    <div
                        class="w-14 h-14 rounded-2xl bg-green-100 flex items-center justify-center text-green-600 text-2xl mb-6">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <h3 class="text-xl font-bold text-oblink-gray mb-3 font-display">Juridique S√©curis√©</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        G√©n√©rez un contrat de prestation blind√© en un clic. √âvitez les risques de requalification gr√¢ce
                        √† nos outils conformes.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Call to Action -->
    <div class="py-20 px-4">
        <div
            class="max-w-5xl mx-auto bg-gray-900 rounded-3xl p-8 md:p-16 text-center transform hover:scale-[1.01] transition duration-500 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-20">
                <div class="absolute right-0 top-0 w-64 h-64 bg-oblink-blue rounded-full blur-3xl"></div>
                <div class="absolute left-0 bottom-0 w-64 h-64 bg-oblink-violet rounded-full blur-3xl"></div>
            </div>

            <div class="relative z-10">
                <h2 class="text-3xl md:text-5xl font-black font-display text-white mb-6">
                    Ne perdez plus de chiffre d'affaires.
                </h2>
                <p class="text-xl text-gray-400 mb-10 max-w-2xl mx-auto font-light">
                    Le co√ªt d'un magasin ferm√© une journ√©e est de 1500‚Ç¨. Un freelance vous co√ªte 3x moins cher.
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <a href="<?php echo home_url('/inscription-entreprise'); ?>"
                        class="px-8 py-4 bg-white text-oblink-gray font-bold rounded-xl shadow-lg hover:bg-gray-100 transition text-lg">
                        Cr√©er un compte Magasin
                    </a>
                </div>
            </div>
        </div>
    </div>

</div>

<?php include get_template_directory() . "/footer-content.php"; wp_footer(); ?>--- FILE: theme/single.php ---
<?php include 'header-inc.php'; ?>

<style>
    /* === ARTICLE STYLING === */
    .article-content {
        font-size: 1.125rem;
        line-height: 1.8;
        color: #1f2937;
    }

    /* Headers */
    .article-content h2 {
        font-size: 2rem;
        font-weight: 700;
        color: #FF6600;
        margin-top: 3rem;
        margin-bottom: 1.5rem;
        border-bottom: 3px solid #FF6600;
        padding-bottom: 0.5rem;
        scroll-margin-top: 120px;
        /* For anchor links */
    }

    .article-content h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: #303030;
        margin-top: 2rem;
        margin-bottom: 1rem;
        scroll-margin-top: 120px;
    }

    /* Paragraphs */
    .article-content p {
        margin-bottom: 1.5rem;
    }

    .article-content strong {
        color: #FF6600;
        font-weight: 700;
    }

    /* Lists */
    .article-content ul,
    .article-content ol {
        margin: 1.5rem 0;
        padding-left: 2rem;
    }

    .article-content li {
        margin-bottom: 0.75rem;
        line-height: 1.8;
    }

    .article-content ul li::marker {
        color: #FF6600;
    }

    .article-content ol li::marker {
        color: #FF6600;
        font-weight: 700;
    }

    /* Tables */
    .article-content table {
        width: 100%;
        margin: 2rem 0;
        border-collapse: collapse;
        background: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        overflow: hidden;
    }

    .article-content table th {
        background: linear-gradient(135deg, #FF6600 0%, #ff8833 100%);
        color: white;
        padding: 1rem;
        text-align: left;
        font-weight: 700;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .article-content table td {
        padding: 1rem;
        border-bottom: 1px solid #e5e7eb;
        font-size: 1rem;
    }

    .article-content table tr:last-child td {
        border-bottom: none;
    }

    .article-content table tr:nth-child(even) {
        background-color: #f9fafb;
    }

    .article-content table tr:hover {
        background-color: #fff7ed;
        transition: background-color 0.2s;
    }

    /* Blockquotes */
    .article-content blockquote {
        background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
        border-left: 5px solid #FF6600;
        padding: 1.5rem 2rem;
        margin: 2rem 0;
        border-radius: 8px;
        font-style: italic;
        font-size: 1.1rem;
        color: #78350f;
        box-shadow: 0 2px 4px rgba(255, 102, 0, 0.1);
    }

    /* Code blocks */
    .article-content pre {
        background: #1e293b;
        color: #e2e8f0;
        padding: 1.5rem;
        border-radius: 12px;
        overflow-x: auto;
        margin: 2rem 0;
        font-family: 'Courier New', monospace;
        font-size: 0.95rem;
        line-height: 1.6;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }

    .article-content code {
        background: #f3f4f6;
        color: #FF6600;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
    }

    .article-content pre code {
        background: none;
        color: inherit;
        padding: 0;
    }

    /* Colored info boxes */
    .article-content div[style*="background"] {
        border-radius: 12px;
        padding: 1.5rem 2rem !important;
        margin: 2rem 0 !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    /* Links */
    .article-content a {
        color: #0099FF;
        font-weight: 600;
        text-decoration: none;
        border-bottom: 2px solid transparent;
        transition: all 0.3s;
    }

    .article-content a:hover {
        color: #9A48D0;
        border-bottom-color: #9A48D0;
    }

    /* Horizontal rules */
    .article-content hr {
        border: none;
        height: 2px;
        background: linear-gradient(90deg, transparent, #FF6600, transparent);
        margin: 3rem 0;
    }

    /* Superscript references */
    .article-content sup {
        font-size: 0.75em;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
        top: -0.5em;
    }

    .article-content sup a {
        color: #0099FF;
        font-weight: 600;
        text-decoration: none;
        padding: 0 2px;
    }

    .article-content sup a:hover {
        color: #9A48D0;
        text-decoration: underline;
    }

    /* Sources section styling */
    .article-content h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: #303030;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }

    .article-content ol {
        background: #f8fafc;
        padding: 1.5rem 2rem 1.5rem 3rem;
        border-radius: 8px;
        border-left: 3px solid #0099FF;
        margin: 1.5rem 0;
    }

    .article-content ol li a {
        color: #0099FF;
        word-break: break-word;
    }

    /* Table of Contents */
    .toc {
        background: #f8fafc;
        border-left: 4px solid #0099FF;
        padding: 1.5rem 2rem;
        margin: 2rem 0;
        border-radius: 8px;
    }

    .toc h3 {
        margin-top: 0 !important;
        color: #0099FF !important;
        border-bottom: none !important;
        font-size: 1.25rem !important;
    }

    .toc ul {
        margin: 1rem 0 0 0;
        padding-left: 1.5rem;
    }

    .toc li {
        margin-bottom: 0.5rem;
    }

    .toc a {
        color: #475569;
        font-weight: 500;
    }

    .toc a:hover {
        color: #0099FF;
    }

    /* Share buttons */
    .share-buttons {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
    }

    .share-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.25rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        transition: all 0.3s;
        text-decoration: none;
        border: none;
        cursor: pointer;
    }

    .share-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .share-linkedin {
        background: #0077b5;
        color: white;
    }

    .share-twitter {
        background: #1DA1F2;
        color: white;
    }

    .share-facebook {
        background: #1877f2;
        color: white;
    }

    .share-email {
        background: #64748b;
        color: white;
    }

    /* Sidebar */
    .sidebar {
        position: sticky;
        top: 120px;
    }

    .sidebar-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        margin-bottom: 1.5rem;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 0;
        border-bottom: 1px solid #e5e7eb;
    }

    .meta-item:last-child {
        border-bottom: none;
    }

    .meta-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #FF6600, #ff8833);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }
</style>

<div class="pt-32 pb-20 px-4 min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-violet-50">
    <div class="max-w-7xl mx-auto">
        <?php
        while (have_posts()):
            the_post();

            // Calculate reading time
            $content = get_the_content();
            $word_count = str_word_count(strip_tags($content));
            $reading_time = ceil($word_count / 200); // 200 words per minute
        
            // Get excerpt for meta description
            $excerpt = get_the_excerpt();

            // Get current URL for sharing
            $current_url = urlencode(get_permalink());
            $title = urlencode(get_the_title());
            ?>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- MAIN CONTENT -->
                <div class="lg:col-span-2">
                    <!-- Article Header -->
                    <div class="mb-8">
                        <div
                            class="inline-flex items-center px-4 py-2 bg-white/60 backdrop-blur-xl border border-white/40 rounded-full mb-6 shadow-sm">
                            <span class="text-sm font-semibold text-oblink-orange uppercase tracking-wider">
                                <?php
                                $categories = get_the_category();
                                if (!empty($categories)) {
                                    echo esc_html($categories[0]->name);
                                } else {
                                    echo 'Article';
                                }
                                ?>
                            </span>
                        </div>

                        <h1 class="text-4xl md:text-5xl font-bold text-oblink-gray mb-6 leading-tight"
                            style="font-family: 'Montserrat', sans-serif;">
                            <?php the_title(); ?>
                        </h1>

                        <?php if ($excerpt): ?>
                            <p class="text-xl text-gray-600 mb-6 leading-relaxed">
                                <?php echo esc_html($excerpt); ?>
                            </p>
                        <?php endif; ?>

                        <div class="flex items-center gap-4 text-gray-500 text-sm">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-calendar"></i>
                                <?php echo get_the_date('d/m/Y'); ?>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-clock"></i>
                                <?php echo $reading_time; ?> min de lecture
                            </div>
                        </div>
                    </div>

                    <!-- Featured Image -->
                    <?php if (has_post_thumbnail()): ?>
                        <div class="rounded-2xl overflow-hidden shadow-xl mb-8">
                            <?php the_post_thumbnail('large', array('class' => 'w-full h-auto object-cover')); ?>
                        </div>
                    <?php endif; ?>

                    <!-- Content -->
                    <div class="glass-card p-8 md:p-12">
                        <div class="article-content">
                            <?php the_content(); ?>
                        </div>

                        <!-- Tags -->
                        <?php if (get_the_tags()): ?>
                            <div class="mt-8 pt-8 border-t border-gray-200">
                                <div class="flex flex-wrap gap-2">
                                    <?php
                                    $tags = get_the_tags();
                                    foreach ($tags as $tag) {
                                        echo '<span class="px-3 py-1 bg-gray-100 rounded-full text-sm text-gray-600">#' . esc_html($tag->name) . '</span>';
                                    }
                                    ?>
                                </div>
                            </div>
                        <?php endif; ?>
                    </div>

                    <!-- Share Section -->
                    <div class="glass-card p-6 mt-8">
                        <h3 class="text-lg font-bold text-oblink-gray mb-4">üì¢ Partager cet article</h3>
                        <div class="share-buttons">
                            <a href="https://www.linkedin.com/sharing/share-offsite/?url=<?php echo $current_url; ?>"
                                target="_blank" class="share-btn share-linkedin">
                                <i class="fab fa-linkedin"></i> LinkedIn
                            </a>
                            <a href="https://twitter.com/intent/tweet?url=<?php echo $current_url; ?>&text=<?php echo $title; ?>"
                                target="_blank" class="share-btn share-twitter">
                                <i class="fab fa-twitter"></i> Twitter
                            </a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u=<?php echo $current_url; ?>"
                                target="_blank" class="share-btn share-facebook">
                                <i class="fab fa-facebook"></i> Facebook
                            </a>
                            <a href="mailto:?subject=<?php echo $title; ?>&body=<?php echo $current_url; ?>"
                                class="share-btn share-email">
                                <i class="fas fa-envelope"></i> Email
                            </a>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-8">
                        <div>
                            <?php previous_post_link('%link', '<div class="glass-card p-4 hover:scale-105 transition transform h-full"><span class="block text-xs text-gray-500 mb-2">‚Üê Article pr√©c√©dent</span><span class="font-bold text-oblink-gray line-clamp-2">%title</span></div>'); ?>
                        </div>
                        <div>
                            <?php next_post_link('%link', '<div class="glass-card p-4 hover:scale-105 transition transform h-full text-right"><span class="block text-xs text-gray-500 mb-2">Article suivant ‚Üí</span><span class="font-bold text-oblink-gray line-clamp-2">%title</span></div>'); ?>
                        </div>
                    </div>
                </div>

                <!-- SIDEBAR -->
                <div class="lg:col-span-1">
                    <div class="sidebar">
                        <!-- Meta Info -->
                        <div class="sidebar-card">
                            <h3 class="font-bold text-oblink-gray mb-4 text-lg">üìã Informations</h3>

                            <div class="meta-item">
                                <div class="meta-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-500">Publi√© le</div>
                                    <div class="font-semibold text-gray-700"><?php echo get_the_date('d/m/Y'); ?></div>
                                </div>
                            </div>

                            <div class="meta-item">
                                <div class="meta-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-500">Temps de lecture</div>
                                    <div class="font-semibold text-gray-700"><?php echo $reading_time; ?> minutes</div>
                                </div>
                            </div>

                            <div class="meta-item">
                                <div class="meta-icon">
                                    <i class="fas fa-folder"></i>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-500">Cat√©gorie</div>
                                    <div class="font-semibold text-gray-700">
                                        <?php echo !empty($categories) ? esc_html($categories[0]->name) : 'Article'; ?>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CTA Card -->
                        <div class="sidebar-card" style="background: linear-gradient(135deg, #FF6600 0%, #ff8833 100%);">
                            <h3 class="font-bold text-white mb-3 text-lg">üöÄ Lancez-vous !</h3>
                            <p class="text-white/90 text-sm mb-4">
                                Cr√©ez votre profil gratuitement et acc√©dez √† des centaines de missions.
                            </p>
                            <a href="<?php echo home_url('/inscription-opticien'); ?>"
                                class="block w-full text-center px-4 py-3 bg-white text-oblink-orange font-bold rounded-lg hover:bg-gray-50 transition">
                                Cr√©er mon compte
                            </a>
                        </div>

                        <!-- Related Links -->
                        <div class="sidebar-card">
                            <h3 class="font-bold text-oblink-gray mb-4 text-lg">üîó Ressources utiles</h3>
                            <ul class="space-y-3">
                                <li>
                                    <a href="<?php echo home_url('/simulateur'); ?>"
                                        class="text-oblink-blue hover:text-oblink-violet flex items-center gap-2">
                                        <i class="fas fa-calculator"></i> Simulateur de revenus
                                    </a>
                                </li>
                                <li>
                                    <a href="<?php echo home_url('/formation-erp'); ?>"
                                        class="text-oblink-blue hover:text-oblink-violet flex items-center gap-2">
                                        <i class="fas fa-graduation-cap"></i> Formations gratuites
                                    </a>
                                </li>
                                <li>
                                    <a href="<?php echo home_url('/emploi-opticien'); ?>"
                                        class="text-oblink-blue hover:text-oblink-violet flex items-center gap-2">
                                        <i class="fas fa-briefcase"></i> Voir les missions
                                    </a>
                                </li>
                                <li>
                                    <a href="<?php echo home_url('/blog'); ?>"
                                        class="text-oblink-blue hover:text-oblink-violet flex items-center gap-2">
                                        <i class="fas fa-newspaper"></i> Tous les articles
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <?php
        endwhile;
        ?>
    </div>
</div>

<script>
    // Auto-generate table of contents from H2 headings
    document.addEventListener('DOMContentLoaded', function () {
        const content = document.querySelector('.article-content');
        const headings = content.querySelectorAll('h2');

        if (headings.length >= 3) {
            const toc = document.createElement('div');
            toc.className = 'toc';
            toc.innerHTML = '<h3>üìë Sommaire</h3><ul></ul>';

            const tocList = toc.querySelector('ul');

            headings.forEach((heading, index) => {
                const id = 'section-' + index;
                heading.id = id;

                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = '#' + id;
                a.textContent = heading.textContent;
                li.appendChild(a);
                tocList.appendChild(li);
            });

            // Insert TOC after first paragraph
            const firstP = content.querySelector('p');
            if (firstP) {
                firstP.after(toc);
            }
        }
    });
</script>

<?php include get_template_directory() . "/footer-content.php";
wp_footer(); ?>--- FILE: theme/page-parametres.php ---
<?php
/*
Template Name: Param√®tres Compte
*/
include 'header-inc.php';
?>

<!-- Auth Guard -->
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        if (!window.oblinkSupabase) {
            console.error('Supabase not loaded');
            return;
        }

        const { data: { session } } = await window.oblinkSupabase.auth.getSession();
        if (!session) {
            window.location.href = '<?php echo home_url('/login'); ?>?redirect=/parametres';
        }
    });
</script>

<div class="min-h-screen bg-gray-50 pt-32 pb-20">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold font-display text-oblink-gray mb-2">Param√®tres du compte</h1>
            <p class="text-gray-500">G√©rez vos informations personnelles et votre s√©curit√©</p>
        </div>

        <!-- Success Message -->
        <div id="success-message" class="hidden mb-6 p-4 rounded-xl bg-green-50 border border-green-200">
            <div class="flex items-start gap-3">
                <i class="fas fa-check-circle text-green-500 text-xl mt-0.5"></i>
                <div>
                    <p class="text-sm font-semibold text-green-700" id="success-text"></p>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div id="error-message" class="hidden mb-6 p-4 rounded-xl bg-red-50 border border-red-200">
            <div class="flex items-start gap-3">
                <i class="fas fa-exclamation-circle text-red-500 text-xl mt-0.5"></i>
                <div>
                    <p class="text-sm font-semibold text-red-700" id="error-text"></p>
                </div>
            </div>
        </div>

        <!-- Warning Message -->
        <div id="warning-message" class="hidden mb-6 p-4 rounded-xl bg-yellow-50 border border-yellow-200">
            <div class="flex items-start gap-3">
                <i class="fas fa-exclamation-triangle text-yellow-600 text-xl mt-0.5"></i>
                <div>
                    <p class="text-sm font-semibold text-yellow-700" id="warning-text"></p>
                </div>
            </div>
        </div>

        <!-- Settings Sections -->
        <div class="space-y-6">

            <!-- Profile Information -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
                <h2 class="text-xl font-bold text-oblink-gray mb-6 flex items-center gap-2">
                    <i class="fas fa-user text-oblink-blue"></i> Informations du profil
                </h2>

                <form id="profile-form" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Pr√©nom</label>
                            <input type="text" id="first-name"
                                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-oblink-blue focus:ring-2 focus:ring-oblink-blue/20 outline-none transition"
                                placeholder="Votre pr√©nom">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Nom</label>
                            <input type="text" id="last-name"
                                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-oblink-blue focus:ring-2 focus:ring-oblink-blue/20 outline-none transition"
                                placeholder="Votre nom">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Email</label>
                        <input type="email" id="email"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-gray-50 cursor-not-allowed"
                            placeholder="email@exemple.com" disabled>
                        <p class="text-xs text-gray-500 mt-1">L'email ne peut pas √™tre modifi√© pour le moment</p>
                    </div>

                    <button type="submit"
                        class="px-6 py-3 bg-oblink-blue text-white font-bold rounded-xl hover:bg-blue-600 transition flex items-center gap-2">
                        <i class="fas fa-save"></i> Enregistrer les modifications
                    </button>
                </form>
            </div>

            <!-- Password Change -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
                <h2 class="text-xl font-bold text-oblink-gray mb-6 flex items-center gap-2">
                    <i class="fas fa-lock text-oblink-orange"></i> S√©curit√©
                </h2>

                <form id="password-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Nouveau mot de passe</label>
                        <input type="password" id="new-password"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-oblink-blue focus:ring-2 focus:ring-oblink-blue/20 outline-none transition"
                            placeholder="Minimum 6 caract√®res">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Confirmer le mot de passe</label>
                        <input type="password" id="confirm-password"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-oblink-blue focus:ring-2 focus:ring-oblink-blue/20 outline-none transition"
                            placeholder="Retapez le mot de passe">
                    </div>

                    <button type="submit"
                        class="px-6 py-3 bg-oblink-orange text-white font-bold rounded-xl hover:bg-orange-600 transition flex items-center gap-2">
                        <i class="fas fa-key"></i> Changer le mot de passe
                    </button>
                </form>
            </div>

            <!-- Logout -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
                <h2 class="text-xl font-bold text-oblink-gray mb-4 flex items-center gap-2">
                    <i class="fas fa-sign-out-alt text-red-500"></i> D√©connexion
                </h2>
                <p class="text-gray-600 mb-4">Vous souhaitez vous d√©connecter de votre compte ?</p>
                <button onclick="logout()"
                    class="px-6 py-3 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition flex items-center gap-2">
                    <i class="fas fa-power-off"></i> Se d√©connecter
                </button>
            </div>

        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        if (!window.oblinkSupabase) return;

        // Load current user data
        const { data: { session } } = await window.oblinkSupabase.auth.getSession();
        if (!session) return;

        const user = session.user;

        // Populate form
        document.getElementById('email').value = user.email || '';
        document.getElementById('first-name').value = user.user_metadata?.first_name || '';
        document.getElementById('last-name').value = user.user_metadata?.last_name || '';

        // Profile form handler
        document.getElementById('profile-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enregistrement...';
            btn.disabled = true;

            try {
                const { error } = await window.oblinkSupabase.auth.updateUser({
                    data: {
                        first_name: document.getElementById('first-name').value,
                        last_name: document.getElementById('last-name').value
                    }
                });

                if (error) throw error;

                btn.innerHTML = '<i class="fas fa-check"></i> Enregistr√© !';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);

            } catch (error) {
                showError('Erreur : ' + error.message);
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        });

        // Password form handler
        document.getElementById('password-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (newPassword.length < 6) {
                showWarning('Le mot de passe doit contenir au moins 6 caract√®res');
                return;
            }

            if (newPassword !== confirmPassword) {
                showWarning('Les mots de passe ne correspondent pas');
                return;
            }

            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Modification...';
            btn.disabled = true;

            try {
                const { error } = await window.oblinkSupabase.auth.updateUser({
                    password: newPassword
                });

                if (error) throw error;

                btn.innerHTML = '<i class="fas fa-check"></i> Mot de passe chang√© !';
                document.getElementById('new-password').value = '';
                document.getElementById('confirm-password').value = '';

                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);

            } catch (error) {
                showError('Erreur : ' + error.message);
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        });
    });

    // Helper functions for messages
    function showSuccess(message) {
        const successDiv = document.getElementById('success-message');
        const successText = document.getElementById('success-text');
        successText.textContent = message;
        successDiv.classList.remove('hidden');
        successDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Hide other messages
        document.getElementById('error-message').classList.add('hidden');
        document.getElementById('warning-message').classList.add('hidden');
    }

    function showError(message) {
        const errorDiv = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');
        errorText.textContent = message;
        errorDiv.classList.remove('hidden');
        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Hide other messages
        document.getElementById('success-message').classList.add('hidden');
        document.getElementById('warning-message').classList.add('hidden');
    }

    function showWarning(message) {
        const warningDiv = document.getElementById('warning-message');
        const warningText = document.getElementById('warning-text');
        warningText.textContent = message;
        warningDiv.classList.remove('hidden');
        warningDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Hide other messages
        document.getElementById('success-message').classList.add('hidden');
        document.getElementById('error-message').classList.add('hidden');
    }

    // Logout function with inline confirmation
    async function logout() {
        // Show confirmation message
        const warningDiv = document.getElementById('warning-message');
        const warningText = document.getElementById('warning-text');
        warningText.innerHTML = `
            √ätes-vous s√ªr de vouloir vous d√©connecter ?
            <div class="mt-3 flex gap-2">
                <button onclick="confirmLogout()" class="px-4 py-2 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition text-sm">
                    Oui, d√©connecter
                </button>
                <button onclick="hideMessages()" class="px-4 py-2 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition text-sm">
                    Annuler
                </button>
            </div>
        `;
        warningDiv.classList.remove('hidden');
        warningDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    async function confirmLogout() {
        try {
            await window.oblinkSupabase.auth.signOut();
            showSuccess('D√©connexion r√©ussie ! Redirection...');
            setTimeout(() => {
                window.location.href = '<?php echo home_url('/'); ?>';
            }, 1000);
        } catch (error) {
            showError('Erreur lors de la d√©connexion : ' + error.message);
        }
    }

    function hideMessages() {
        document.getElementById('success-message').classList.add('hidden');
        document.getElementById('error-message').classList.add('hidden');
        document.getElementById('warning-message').classList.add('hidden');
    }
</script>

<?php
include get_template_directory() . "/footer-content.php";
wp_footer();
?>--- FILE: theme/page-publier-offre.php ---
<?php
/*
Template Name: Page Publier Offre
*/
include 'header-inc.php';

// Protection removed to allow Supabase client-side auth
// if (!is_user_logged_in()) { wp_redirect... }
?>

<!-- Auth Loading State -->
<div id="auth-loading" class="min-h-screen bg-gray-50 flex flex-col items-center justify-center pt-20">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-oblink-orange mb-4"></div>
    <p class="text-gray-500 font-medium">V√©rification de vos acc√®s...</p>
</div>

<!-- Protected Content (Hidden by default) -->
<div id="auth-protected-content" class="min-h-screen bg-gray-50 pt-24 pb-12 hidden">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Header -->
        <div class="mb-8 text-center">
            <a href="<?php echo home_url('/dashboard-entreprise'); ?>"
                class="inline-flex items-center text-gray-500 hover:text-oblink-blue mb-4 transition">
                <i class="fas fa-arrow-left mr-2"></i> Retour au Dashboard
            </a>
            <h1 class="text-3xl font-bold font-display text-oblink-gray">Publier une nouvelle mission</h1>
            <p class="text-gray-500 mt-2">Trouvez le candidat id√©al en quelques clics.</p>
        </div>

        <!-- Formulaire -->
        <form id="publish-offer-form" class="bg-white rounded-3xl shadow-sm border border-gray-100 overflow-hidden">

            <div class="p-8 space-y-8">

                <!-- Quick Templates (New Feature) -->
                <div class="bg-blue-50 p-4 rounded-2xl mb-6 border border-blue-100">
                    <h3 class="text-sm font-bold text-blue-800 mb-3"><i class="fas fa-bolt mr-2"></i>Remplissage Rapide
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        <button type="button" onclick="fillTemplate('rempla')"
                            class="px-3 py-1.5 bg-white text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-100 border border-blue-200 transition">
                            Remplacement √ât√©
                        </button>
                        <button type="button" onclick="fillTemplate('cdi')"
                            class="px-3 py-1.5 bg-white text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-100 border border-blue-200 transition">
                            CDI Collaborateur
                        </button>
                        <button type="button" onclick="fillTemplate('samedi')"
                            class="px-3 py-1.5 bg-white text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-100 border border-blue-200 transition">
                            Renfort Samedi
                        </button>
                    </div>
                </div>

                <!-- Section 1: Le Poste -->
                <div>
                    <h2 class="text-xl font-bold text-oblink-gray mb-4 flex items-center">
                        <span
                            class="w-8 h-8 rounded-full bg-oblink-blue/10 text-oblink-blue flex items-center justify-center text-sm mr-3">1</span>
                        D√©tails du poste
                    </h2>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Intitul√© de la mission</label>
                            <input type="text" name="job_title" placeholder="Ex: Opticien Collaborateur / Rempla√ßant..."
                                required
                                class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition font-bold text-oblink-gray placeholder-gray-400">
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Type de poste recherch√© <span
                                    class="text-red-500">*</span></label>
                            <select name="job_type" required
                                class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition font-medium cursor-pointer">
                                <optgroup label="üíº En Magasin">
                                    <option value="Opticien collaborateur H/F">Opticien collaborateur H/F</option>
                                    <option value="Opticien rempla√ßant H/F">Opticien rempla√ßant H/F</option>
                                    <option value="Opticien en alternance H/F">Opticien en alternance H/F</option>
                                    <option value="Opticien directeur, g√©rant ou responsable H/F">Opticien
                                        directeur/g√©rant H/F</option>
                                    <option value="Opticien tiers payant H/F">Opticien tiers payant H/F</option>
                                    <option value="Vendeur H/F">Vendeur H/F</option>
                                    <option value="Monteur H/F">Monteur H/F</option>
                                    <option value="Monteur-vendeur H/F">Monteur-vendeur H/F</option>
                                    <option value="Conseiller vendeur de solaires H/F">Conseiller solaires H/F</option>
                                    <option value="Audioproth√©siste H/F">Audioproth√©siste H/F</option>
                                    <option value="Assistant audioproth√©siste H/F">Assistant audioproth√©siste H/F
                                    </option>
                                    <option value="Adaptateur de lentilles H/F">Adaptateur de lentilles H/F</option>
                                </optgroup>
                                <optgroup label="üöó Nomades / Terrain">
                                    <option value="Opticien √† domicile H/F">Opticien √† domicile H/F</option>
                                    <option value="Agent - Commercial - VRP H/F">Agent VRP H/F</option>
                                    <option value="Animateur r√©seau H/F">Animateur r√©seau H/F</option>
                                    <option value="Responsable de secteur H/F">Responsable de secteur H/F</option>
                                </optgroup>
                                <optgroup label="üëî Experts / Management">
                                    <option value="Responsable technique H/F">Responsable technique H/F</option>
                                    <option value="Optom√©triste H/F">Optom√©triste H/F</option>
                                    <option value="Directeur des ventes H/F">Directeur des ventes H/F</option>
                                    <option value="Chef de produits H/F">Chef de produits H/F</option>
                                </optgroup>
                                <optgroup label="ü©∫ Autres Professions">
                                    <option value="Orthoptiste H/F">Orthoptiste H/F</option>
                                    <option value="AMO (Assistant m√©dical ophta) H/F">AMO (Assistant m√©dical ophta) H/F
                                    </option>
                                    <option value="Enseignant H/F">Enseignant optique H/F</option>
                                    <option value="Autre en magasin H/F">Autre en magasin H/F</option>
                                    <option value="Autre H/F">Autre profession H/F</option>
                                </optgroup>
                            </select>
                            <p class="text-xs text-gray-400 mt-1">Choisissez le profil qui correspond le mieux √† votre
                                besoin</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Type de contrat</label>
                                <select name="contract_type"
                                    class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition font-medium cursor-pointer">
                                    <option value="cdd">CDD (Remplacement)</option>
                                    <option value="cdi">CDI</option>
                                    <option value="freelance">Freelance / Vacation</option>
                                    <option value="stage">Stage / Alternance</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Salaire / Taux
                                    journalier</label>
                                <div class="relative">
                                    <input type="number" name="salary" placeholder="Ex: 350" required
                                        class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition">
                                    <span class="absolute right-4 top-3 text-gray-400 font-bold">‚Ç¨</span>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Montant brut ou journalier (chiffre uniquement)
                                </p>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Description du poste</label>
                            <textarea name="description" rows="4"
                                placeholder="D√©crivez les missions, l'ambiance, les avantages..."
                                class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition text-sm"></textarea>
                        </div>
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Section 2: Planning & Lieu -->
                <div>
                    <h2 class="text-xl font-bold text-oblink-gray mb-4 flex items-center">
                        <span
                            class="w-8 h-8 rounded-full bg-oblink-violet/10 text-oblink-violet flex items-center justify-center text-sm mr-3">2</span>
                        Planning & Lieu
                    </h2>

                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Date de d√©but</label>
                                <input type="date" name="start_date" required
                                    class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Date de fin
                                    (Optionnel)</label>
                                <input type="date" name="end_date"
                                    class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Ville</label>
                            <input type="text" name="location" placeholder="Ex: Paris" required
                                class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Adresse compl√®te (Priv√©)</label>
                            <input type="text" name="address" placeholder="Ex: 15 rue de Rivoli, 75004 Paris"
                                class="w-full px-4 py-3 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition">
                            <p class="text-xs text-gray-400 mt-1">L'adresse exacte ne sera communiqu√©e qu'aux candidats
                                valid√©s.</p>
                        </div>
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Section 3: Comp√©tences (Logiciels) -->
                <div>
                    <h2 class="text-xl font-bold text-oblink-gray mb-4 flex items-center">
                        <span
                            class="w-8 h-8 rounded-full bg-oblink-orange/10 text-oblink-orange flex items-center justify-center text-sm mr-3">3</span>
                        Logiciel utilis√©
                    </h2>

                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <label class="cursor-pointer group">
                            <input type="checkbox" name="skills[]" value="WinOptics" class="peer hidden">
                            <div
                                class="p-3 bg-gray-50 rounded-xl text-center border-2 border-transparent peer-checked:border-oblink-orange peer-checked:bg-orange-50 transition">
                                <span
                                    class="font-bold text-sm text-gray-600 peer-checked:text-oblink-orange">WinOptics</span>
                            </div>
                        </label>
                        <label class="cursor-pointer group">
                            <input type="checkbox" name="skills[]" value="Cosium" class="peer hidden">
                            <div
                                class="p-3 bg-gray-50 rounded-xl text-center border-2 border-transparent peer-checked:border-oblink-orange peer-checked:bg-orange-50 transition">
                                <span
                                    class="font-bold text-sm text-gray-600 peer-checked:text-oblink-orange">Cosium</span>
                            </div>
                        </label>
                        <label class="cursor-pointer group">
                            <input type="checkbox" name="skills[]" value="Irris" class="peer hidden">
                            <div
                                class="p-3 bg-gray-50 rounded-xl text-center border-2 border-transparent peer-checked:border-oblink-orange peer-checked:bg-orange-50 transition">
                                <span
                                    class="font-bold text-sm text-gray-600 peer-checked:text-oblink-orange">Irris</span>
                            </div>
                        </label>
                        <label class="cursor-pointer group relative">
                            <input type="checkbox" name="skills[]" value="Autre" class="peer hidden"
                                id="skill-other-checkbox" onchange="toggleOtherSkillInput(this)">
                            <div
                                class="p-3 bg-gray-50 rounded-xl text-center border-2 border-transparent peer-checked:border-oblink-orange peer-checked:bg-orange-50 transition">
                                <span
                                    class="font-bold text-sm text-gray-600 peer-checked:text-oblink-orange">Autre</span>
                            </div>
                        </label>
                    </div>
                    <!-- Input cach√© pour 'Autre' -->
                    <div id="skill-other-container" class="mt-3 hidden">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Pr√©cisez le logiciel</label>
                        <input type="text" id="skill-other-input" placeholder="Ex: PHOENIX, LEO..."
                            class="w-full px-4 py-2 rounded-xl bg-gray-50 border-transparent focus:bg-white focus:border-oblink-blue focus:ring-0 transition text-sm font-bold text-gray-700">
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Section 4: Options Payantes (Boost) -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-2xl p-6 border border-yellow-100">
                    <h2 class="text-xl font-bold text-oblink-gray mb-4 flex items-center">
                        <span
                            class="w-8 h-8 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center text-sm mr-3"><i
                                class="fas fa-rocket"></i></span>
                        Options de Visibilit√©
                    </h2>

                    <div class="space-y-3">
                        <label
                            class="flex items-start p-4 bg-white rounded-xl border border-yellow-100 cursor-pointer hover:border-yellow-300 transition">
                            <input type="checkbox" name="options[]" value="urgent"
                                class="mt-1 w-5 h-5 text-oblink-orange rounded focus:ring-oblink-orange border-gray-300">
                            <div class="ml-3">
                                <span class="block font-bold text-gray-800">Logo "URGENT" <span
                                        class="bg-yellow-100 text-yellow-700 text-xs px-2 py-0.5 rounded ml-2">10‚Ç¨</span></span>
                                <span class="block text-sm text-gray-500">Mettez un logo urgent pour d√©marquer votre
                                    annonce pendant 30 jours.</span>
                            </div>
                        </label>

                        <label
                            class="flex items-start p-4 bg-white rounded-xl border border-yellow-100 cursor-pointer hover:border-yellow-300 transition">
                            <input type="checkbox" name="options[]" value="top_list"
                                class="mt-1 w-5 h-5 text-oblink-orange rounded focus:ring-oblink-orange border-gray-300">
                            <div class="ml-3">
                                <span class="block font-bold text-gray-800">Remont√©e en t√™te de liste <span
                                        class="bg-yellow-100 text-yellow-700 text-xs px-2 py-0.5 rounded ml-2">15‚Ç¨</span></span>
                                <span class="block text-sm text-gray-500">Remontez votre annonce en haut des r√©sultats
                                    chaque semaine.</span>
                            </div>
                        </label>
                    </div>
                </div>

            </div>

            <!-- Footer Actions -->
            <div
                class="bg-gray-50 px-8 py-6 flex flex-col md:flex-row items-center justify-between gap-4 border-t border-gray-100">
                <p class="text-xs text-gray-400 text-center md:text-left">
                    <i class="fas fa-info-circle mr-1"></i> Votre offre sera soumise √† validation.
                </p>
                <div class="flex gap-4 w-full md:w-auto">
                    <a href="<?php echo home_url('/dashboard-entreprise'); ?>"
                        class="flex-1 md:flex-none py-3 px-6 rounded-xl font-bold text-gray-500 hover:bg-gray-200 text-center transition">
                        Annuler
                    </a>
                    <button type="submit" id="submit-btn"
                        class="flex-1 md:flex-none py-3 px-8 bg-oblink-blue text-white rounded-xl font-bold hover:bg-oblink-gray transition shadow-lg shadow-blue-200">
                        Publier l'offre
                    </button>
                </div>
            </div>

        </form>

    </div>
</div>

<!-- Auth Guard: Redirect to login if not authenticated -->
<script>
    (async function () {
        try {
            console.log('[PUBLIER-OFFRE] üîí Auth guard starting...');

            // Wait for Supabase to be ready (with timeout)
            let attempts = 0;
            while (!window.oblinkSupabase && attempts < 20) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }

            if (!window.oblinkSupabase) {
                console.error('[PUBLIER-OFFRE] ‚ùå Supabase timeout');
                window.location.href = '<?php echo home_url('/login?redirect=/publier-offre'); ?>';
                return;
            }

            console.log('[PUBLIER-OFFRE] ‚úÖ Supabase loaded');

            // Check session
            const { data: { session }, error } = await window.oblinkSupabase.auth.getSession();

            console.log('[PUBLIER-OFFRE] Session:', session ? '‚úÖ Active' : '‚ùå None');

            if (!session) {
                console.log('[PUBLIER-OFFRE] üîÑ Redirecting to login...');
                window.location.href = '<?php echo home_url('/login?redirect=/publier-offre'); ?>';
                return;
            }

            // Check if user is an entreprise
            const userType = session.user.user_metadata?.user_type;
            console.log('[PUBLIER-OFFRE] User type:', userType);

            if (userType !== 'entreprise') {
                alert('Cette page est r√©serv√©e aux entreprises. Redirection...');
                window.location.href = '<?php echo home_url('/'); ?>';
                return;
            }

            // User is authenticated and is an entreprise - show the form
            console.log('[PUBLIER-OFFRE] ‚úÖ Access granted!');
            document.getElementById('auth-loading').classList.add('hidden');
            document.getElementById('auth-protected-content').classList.remove('hidden');
        } catch (error) {
            console.error('[PUBLIER-OFFRE] ‚ùå Error:', error);
            window.location.href = '<?php echo home_url('/login?redirect=/publier-offre'); ?>';
        }
    })();
</script>

<script>
    function fillTemplate(type) {
        const form = document.querySelector('form');
        const typeSelect = form.querySelector('[name="contract_type"]');

        if (type === 'rempla') {
            form.querySelector('[name="job_title"]').value = 'Opticien Rempla√ßant (Juillet/Ao√ªt)';
            typeSelect.value = 'cdd';
            form.querySelector('[name="salary"]').value = '350';
            form.querySelector('[name="location"]').value = 'Paris';
            form.querySelector('[name="description"]').value = 'Cherche rempla√ßant autonome pour la p√©riode estivale. Magasin de quartier, ambiance familiale. Logiciel WinOptics. Horaires : 10h-19h.';
        } else if (type === 'cdi') {
            form.querySelector('[name="job_title"]').value = 'Opticien Collaborateur Polyvalent';
            typeSelect.value = 'cdi';
            form.querySelector('[name="salary"]').value = '2600.00';
            form.querySelector('[name="description"]').value = 'Poste polyvalent (Vente, Atelier, R√©fraction, Tiers-Payant). Nous cherchons un profil dynamique et souriant pour rejoindre notre √©quipe de 4 opticiens.';
        } else if (type === 'samedi') {
            form.querySelector('[name="job_title"]').value = 'Renfort Samedi';
            typeSelect.value = 'freelance';
            form.querySelector('[name="salary"]').value = '300';
            form.querySelector('[name="description"]').value = 'Besoin d\'un renfort pour les samedis. Forte affluence. Vente uniquement. Repas pris en charge.';
        }

        // Trigger change event to update date validation
        typeSelect.dispatchEvent(new Event('change'));

        // Visual feedback
        const btn = event.target;
        const originalText = btn.innerText;
        btn.innerText = 'Rempli !';
        btn.classList.add('bg-green-500', 'text-white', 'border-green-500');
        btn.classList.remove('bg-white', 'text-blue-600');
        setTimeout(() => {
            btn.innerText = originalText;
            btn.classList.remove('bg-green-500', 'text-white', 'border-green-500');
            btn.classList.add('bg-white', 'text-blue-600');
        }, 1000);
    }

    document.addEventListener('DOMContentLoaded', function () {
        const typeSelect = document.querySelector('select[name="contract_type"]');
        const endDateInput = document.querySelector('input[name="end_date"]');
        const endDateLabel = endDateInput.previousElementSibling; // Label est juste avant
        const form = document.getElementById('publish-offer-form');
        const submitBtn = document.getElementById('submit-btn');

        function updateDateFields() {
            const val = typeSelect.value;
            // CDD ou Freelance = Date de fin requise
            if (val === 'cdd' || val === 'freelance') {
                endDateInput.required = true;
                endDateLabel.innerHTML = "Date de fin <span class='text-red-500'>*</span>";
                endDateLabel.classList.add('text-oblink-orange');
            } else {
                // CDI ou Stage = Optionnel
                endDateInput.required = false;
                endDateLabel.innerHTML = "Date de fin (Optionnel)";
                endDateLabel.classList.remove('text-oblink-orange');
            }
        }

        typeSelect.addEventListener('change', updateDateFields);
        updateDateFields(); // Run on init

        // Toggle function needs to be global or attached to window because it's called inline via onchange="toggleOtherSkillInput(this)"
        window.toggleOtherSkillInput = function (checkbox) {
            const container = document.getElementById('skill-other-container');
            const input = document.getElementById('skill-other-input');
            if (checkbox.checked) {
                container.classList.remove('hidden');
                setTimeout(() => input.focus(), 100);
            } else {
                container.classList.add('hidden');
                input.value = '';
            }
        };

        // Supabase Submission
        form.addEventListener('submit', async function (e) {
            e.preventDefault();

            // UI Loading
            const originalBtnContent = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Publication...';
            submitBtn.disabled = true;

            try {
                // 1. Check Session
                const { data: { session } } = await window.oblinkSupabase.auth.getSession();
                if (!session) {
                    throw new Error("Vous devez √™tre connect√© pour publier une offre.");
                }
                const user = session.user;

                // Collect Options
                const options = [];
                form.querySelectorAll('input[name="options[]"]:checked').forEach(cb => options.push(cb.value));

                // Collect Skills (Software)
                const software = [];
                form.querySelectorAll('input[name="skills[]"]:checked').forEach(cb => {
                    if (cb.value === 'Autre') {
                        const otherVal = document.getElementById('skill-other-input').value.trim();
                        if (otherVal) software.push(otherVal);
                    } else {
                        software.push(cb.value);
                    }
                });

                // Prepare Data for Upsert
                // FIX: Parsons le salaire pour √©viter "numeric field overflow" si une chaine vide ou format incorrect est envoy√©
                let salaryVal = parseFloat(form.querySelector('[name="salary"]').value);
                if (isNaN(salaryVal)) salaryVal = 0; // Default to 0 or handle error

                const offerData = {
                    company_id: user.id, // Linked to auth.users.id which maps to profiles.id via trigger usually, or we use profile id
                    title: form.querySelector('[name="job_title"]').value,
                    job_type: form.querySelector('[name="job_type"]').value, // NEW: Type de poste
                    contract_type: form.querySelector('[name="contract_type"]').value,
                    salary: salaryVal, // Numeric
                    city: form.querySelector('[name="location"]').value,
                    address: form.querySelector('[name="address"]').value, // Optional
                    description: form.querySelector('[name="description"]').value,
                    skills_needed: software, // We store software in skills_needed array
                    start_date: form.querySelector('[name="start_date"]').value,
                    end_date: form.querySelector('[name="end_date"]').value || null,
                    status: 'active',
                    is_urgent: options.includes('urgent'),
                    is_top_list: options.includes('top_list')
                };

                // 3. Insert into Supabase
                const { data, error } = await window.oblinkSupabase
                    .from('offers')
                    .insert([offerData])
                    .select();

                if (error) throw error;

                // 4. Success
                // Global Toast (if available) or redirect
                if (typeof showToast === 'function') {
                    showToast('Offre publi√©e avec succ√®s !', 'success');
                }

                // 5. TRIGGER NOTIFICATION SYSTEM (Email/SMS to Experts)
                console.log('[PUBLIER-OFFRE] Triggering alerts...');
                const formData = new FormData();
                formData.append('action', 'trigger_mission_alert');
                formData.append('title', offerData.title);
                formData.append('city', offerData.city);
                formData.append('type', offerData.job_type);
                formData.append('salary', offerData.salary);

                fetch('<?php echo admin_url('admin-ajax.php'); ?>', {
                    method: 'POST',
                    body: formData
                }).then(res => res.json()).then(res => {
                    console.log('[NOTIFICATIONS] Result:', res);
                    if (res.success) {
                        // Display the reassuring message from the backend (Matching Engine)
                        alert("‚úÖ SUCC√àS : L'offre est en ligne !\nüì≤ " + res.data.message);
                    }
                });

                // Redirect to Dashboard
                setTimeout(() => {
                    window.location.href = '<?php echo home_url('/dashboard-entreprise?success=job_posted'); ?>';
                }, 1000);

            } catch (err) {
                console.error('Error publishing offer:', err);
                alert('Erreur: ' + (err.message || "Impossible de publier l'offre."));
                submitBtn.innerHTML = originalBtnContent;
                submitBtn.disabled = false;
            }
        });
    });
</script>

<?php include get_template_directory() . "/footer-content.php";
wp_footer(); ?>--- FILE: theme/page-ville-seo.php ---
<?php
/*
Template Name: Ville SEO Local
*/

/**
 * Template pour pages SEO locales
 * Exemple d'utilisation : /opticien-freelance-paris
 * 
 * Variables √† configurer via Custom Fields ou directement dans la page :
 * - ville_nom : "Paris"
 * - ville_code : "75"
 * - ville_region : "√éle-de-France"
 */

include 'header-inc.php';

// Get city data from post meta or page slug
global $post;
$ville_nom = get_post_meta($post->ID, 'ville_nom', true) ?: 'Paris';
$ville_code = get_post_meta($post->ID, 'ville_code', true) ?: '75';
$ville_region = get_post_meta($post->ID, 'ville_region', true) ?: '√éle-de-France';
$ville_nb_magasins = get_post_meta($post->ID, 'ville_nb_magasins', true) ?: '450+';
$ville_nb_opticiens = get_post_meta($post->ID, 'ville_nb_opticiens', true) ?: '2 300+';
$ville_taux_jour_min = get_post_meta($post->ID, 'ville_taux_jour_min', true) ?: '280';
$ville_taux_jour_max = get_post_meta($post->ID, 'ville_taux_jour_max', true) ?: '350';
?>

<!-- Hero Section -->
<section class="pt-32 pb-20 bg-gradient-to-br from-orange-50 via-white to-violet-50 relative overflow-hidden">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center max-w-4xl mx-auto">
            <!-- Breadcrumbs -->
            <nav class="text-sm text-gray-500 mb-6">
                <a href="<?php echo home_url('/'); ?>" class="hover:text-oblink-orange">Accueil</a>
                <span class="mx-2">‚Üí</span>
                <a href="<?php echo home_url('/emploi-opticien'); ?>" class="hover:text-oblink-orange">Emploi
                    Opticien</a>
                <span class="mx-2">‚Üí</span>
                <span class="text-oblink-gray font-semibold">
                    <?php echo esc_html($ville_nom); ?>
                </span>
            </nav>

            <!-- Main Title -->
            <h1 class="text-5xl md:text-6xl font-bold mb-6 font-display text-oblink-gray">
                Opticien Freelance √† <span class="text-oblink-orange">
                    <?php echo esc_html($ville_nom); ?>
                </span>
            </h1>

            <p class="text-xl text-gray-600 mb-8 leading-relaxed">
                Trouvez des missions pour professionnels de l'optique √†
                <?php echo esc_html($ville_nom); ?> et en
                <?php echo esc_html($ville_region); ?>.
                OBLINK connecte les opticiens, vendeurs, monteurs, audioproth√©sistes et tous les professionnels de
                l'optique aux meilleurs magasins de la r√©gion.
            </p>

            <!-- CTA Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12">
                <a href="<?php echo home_url('/inscription-opticien'); ?>"
                    class="px-8 py-4 bg-oblink-orange text-white rounded-lg font-bold hover:bg-oblink-orange/90 transition shadow-lg">
                    <i class="fas fa-user-plus mr-2"></i>Cr√©er mon profil gratuit
                </a>
                <a href="<?php echo home_url('/emploi-opticien'); ?>"
                    class="px-8 py-4 bg-white text-oblink-gray border-2 border-gray-200 rounded-lg font-bold hover:border-oblink-orange transition">
                    <i class="fas fa-search mr-2"></i>Voir les missions
                </a>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-white rounded-xl p-6 shadow-md border border-gray-100">
                    <div class="text-3xl font-bold text-oblink-orange mb-2">
                        <?php echo esc_html($ville_nb_magasins); ?>
                    </div>
                    <div class="text-sm text-gray-600">Magasins d'optique</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md border border-gray-100">
                    <div class="text-3xl font-bold text-oblink-blue mb-2">
                        <?php echo esc_html($ville_nb_opticiens); ?>
                    </div>
                    <div class="text-sm text-gray-600">Professionnels actifs</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md border border-gray-100">
                    <div class="text-3xl font-bold text-oblink-violet mb-2">
                        <?php echo esc_html($ville_taux_jour_min); ?>-
                        <?php echo esc_html($ville_taux_jour_max); ?>‚Ç¨
                    </div>
                    <div class="text-sm text-gray-600">Taux journalier</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md border border-gray-100">
                    <div class="text-3xl font-bold text-green-600 mb-2">48h</div>
                    <div class="text-sm text-gray-600">R√©ponse moyenne</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Missions Section -->
<section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-4xl font-bold text-oblink-gray mb-12 text-center font-display">
            üéØ Missions disponibles √†
            <?php echo esc_html($ville_nom); ?>
        </h2>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            <!-- Mission Card 1 -->
            <div
                class="bg-gradient-to-br from-orange-50 to-white p-6 rounded-2xl border border-orange-100 hover:shadow-xl transition">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-oblink-orange/10 flex items-center justify-center">
                        <i class="fas fa-calendar-alt text-oblink-orange text-xl"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-oblink-gray">Remplacements cong√©s</h3>
                        <p class="text-sm text-gray-500">
                            <?php echo esc_html($ville_nom); ?> Centre
                        </p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Missions √©t√© 2026, dur√©e 2-4 semaines. √âquipe sympathique,
                    quartier dynamique.</p>
                <div class="flex items-center justify-between">
                    <span class="text-oblink-orange font-bold">
                        <?php echo esc_html($ville_taux_jour_min); ?>‚Ç¨/jour
                    </span>
                    <a href="<?php echo home_url('/emploi-opticien'); ?>"
                        class="text-sm text-oblink-blue hover:underline">
                        Voir d√©tails ‚Üí
                    </a>
                </div>
            </div>

            <!-- Mission Card 2 -->
            <div
                class="bg-gradient-to-br from-blue-50 to-white p-6 rounded-2xl border border-blue-100 hover:shadow-xl transition">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-oblink-blue/10 flex items-center justify-center">
                        <i class="fas fa-briefcase text-oblink-blue text-xl"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-oblink-gray">CDD 3-6 mois</h3>
                        <p class="text-sm text-gray-500">
                            <?php echo esc_html($ville_nom); ?>
                            <?php echo esc_html($ville_code); ?>
                        </p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Magasin premium, client√®le haut de gamme. Verres Essilor,
                    lentilles CooperVision.</p>
                <div class="flex items-center justify-between">
                    <span class="text-oblink-blue font-bold">
                        <?php echo esc_html($ville_taux_jour_max); ?>‚Ç¨/jour
                    </span>
                    <a href="<?php echo home_url('/emploi-opticien'); ?>"
                        class="text-sm text-oblink-blue hover:underline">
                        Voir d√©tails ‚Üí
                    </a>
                </div>
            </div>

            <!-- Mission Card 3 -->
            <div
                class="bg-gradient-to-br from-violet-50 to-white p-6 rounded-2xl border border-violet-100 hover:shadow-xl transition">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-oblink-violet/10 flex items-center justify-center">
                        <i class="fas fa-clock text-oblink-violet text-xl"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-oblink-gray">Missions week-end</h3>
                        <p class="text-sm text-gray-500">Plusieurs arrondissements</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Samedi et/ou dimanche. Id√©al compl√©ment activit√©. Flexibilit√©
                    horaire.</p>
                <div class="flex items-center justify-between">
                    <span class="text-oblink-violet font-bold">300‚Ç¨/jour</span>
                    <a href="<?php echo home_url('/emploi-opticien'); ?>"
                        class="text-sm text-oblink-blue hover:underline">
                        Voir d√©tails ‚Üí
                    </a>
                </div>
            </div>
        </div>

        <div class="text-center">
            <a href="<?php echo home_url('/emploi-opticien'); ?>"
                class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-oblink-orange to-oblink-violet text-white rounded-xl font-bold hover:shadow-xl transition">
                <i class="fas fa-search mr-2"></i>
                Voir toutes les missions √†
                <?php echo esc_html($ville_nom); ?>
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>
</section>

<!-- March√© Local Section -->
<section class="py-20 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid md:grid-cols-2 gap-12 items-center">
            <div>
                <h2 class="text-4xl font-bold text-oblink-gray mb-6 font-display">
                    üìä March√© de l'optique √†
                    <?php echo esc_html($ville_nom); ?>
                </h2>

                <div class="space-y-6">
                    <div class="flex items-start gap-4">
                        <div
                            class="w-12 h-12 rounded-full bg-oblink-orange/10 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-store text-oblink-orange text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">
                                <?php echo esc_html($ville_nb_magasins); ?> magasins d'optique
                            </h3>
                            <p class="text-gray-600">Grande concentration de magasins ind√©pendants et enseignes
                                nationales. Forte demande de professionnels qualifi√©s.</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-4">
                        <div
                            class="w-12 h-12 rounded-full bg-oblink-blue/10 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-users text-oblink-blue text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">
                                <?php echo esc_html($ville_nb_opticiens); ?> opticiens en
                                <?php echo esc_html($ville_region); ?>
                            </h3>
                            <p class="text-gray-600">March√© dynamique avec de nombreuses opportunit√©s pour opticiens
                                freelances et ind√©pendants.</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-euro-sign text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">Taux journalier moyen :
                                <?php echo esc_html($ville_taux_jour_min); ?>-
                                <?php echo esc_html($ville_taux_jour_max); ?>‚Ç¨/jour
                            </h3>
                            <p class="text-gray-600">R√©mun√©ration attractive, parmi les plus √©lev√©es de France. Nombreux
                                quartiers premium.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-8 rounded-2xl shadow-xl border border-gray-100">
                <h3 class="text-2xl font-bold text-oblink-gray mb-6">Secteurs recherch√©s</h3>
                <div class="grid grid-cols-2 gap-4">
                    <?php
                    // Quartiers populaires par d√©faut (peut √™tre personnalis√© par ville)
                    $quartiers = ['Centre', 'Nord', 'Sud', 'Est', 'Ouest', 'P√©riph√©rie'];
                    foreach ($quartiers as $quartier):
                        ?>
                        <div class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg">
                            <i class="fas fa-map-marker-alt text-oblink-orange"></i>
                            <span class="font-semibold">
                                <?php echo esc_html($ville_nom); ?>
                                <?php echo esc_html($quartier); ?>
                            </span>
                        </div>
                    <?php endforeach; ?>
                </div>
                <p class="text-sm text-gray-500 mt-6">+ Banlieue proche et d√©partement
                    <?php echo esc_html($ville_code); ?>
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Pourquoi OBLINK Section -->
<section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-4xl font-bold text-oblink-gray mb-12 text-center font-display">
            üíº Pourquoi choisir OBLINK √†
            <?php echo esc_html($ville_nom); ?> ?
        </h2>

        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="bg-gradient-to-br from-orange-50 to-white p-6 rounded-2xl border border-orange-100 text-center">
                <div class="w-16 h-16 rounded-full bg-oblink-orange/10 flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-building text-oblink-orange text-2xl"></i>
                </div>
                <h3 class="font-bold text-lg mb-2">Meilleures enseignes</h3>
                <p class="text-gray-600 text-sm">Acc√®s aux magasins premium de
                    <?php echo esc_html($ville_nom); ?>
                </p>
            </div>

            <div class="bg-gradient-to-br from-blue-50 to-white p-6 rounded-2xl border border-blue-100 text-center">
                <div class="w-16 h-16 rounded-full bg-oblink-blue/10 flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-map-marked-alt text-oblink-blue text-2xl"></i>
                </div>
                <h3 class="font-bold text-lg mb-2">Tous arrondissements</h3>
                <p class="text-gray-600 text-sm">Missions dans toute la ville et p√©riph√©rie</p>
            </div>

            <div class="bg-gradient-to-br from-violet-50 to-white p-6 rounded-2xl border border-violet-100 text-center">
                <div class="w-16 h-16 rounded-full bg-oblink-violet/10 flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-handshake text-oblink-violet text-2xl"></i>
                </div>
                <h3 class="font-bold text-lg mb-2">Accompagnement local</h3>
                <p class="text-gray-600 text-sm">Support transport & h√©bergement si besoin</p>
            </div>

            <div class="bg-gradient-to-br from-green-50 to-white p-6 rounded-2xl border border-green-100 text-center">
                <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-bolt text-green-600 text-2xl"></i>
                </div>
                <h3 class="font-bold text-lg mb-2">Paiement rapide</h3>
                <p class="text-gray-600 text-sm">R√®glement sous 48h apr√®s mission</p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Final -->
<section class="py-24 bg-gradient-to-br from-oblink-gray via-gray-800 to-gray-900 text-white relative overflow-hidden">
    <div class="absolute inset-0 opacity-10">
        <div class="absolute top-0 right-0 w-96 h-96 bg-oblink-orange rounded-full blur-3xl"></div>
        <div class="absolute bottom-0 left-0 w-96 h-96 bg-oblink-violet rounded-full blur-3xl"></div>
    </div>

    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
        <h2 class="text-4xl md:text-5xl font-bold mb-6 font-display">
            Pr√™t √† trouver votre prochaine mission √†
            <?php echo esc_html($ville_nom); ?> ?
        </h2>
        <p class="text-xl text-gray-300 mb-10">
            Rejoignez +500 professionnels de l'optique qui font confiance √† OBLINK pour trouver les meilleures
            opportunit√©s.
        </p>

        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="<?php echo home_url('/inscription-opticien'); ?>"
                class="px-8 py-4 bg-oblink-orange text-white rounded-lg font-bold hover:bg-oblink-orange/90 transition shadow-lg">
                <i class="fas fa-user-plus mr-2"></i>Cr√©er mon profil gratuit
            </a>
            <a href="<?php echo home_url('/emploi-opticien'); ?>"
                class="px-8 py-4 bg-white text-oblink-gray rounded-lg font-bold hover:bg-gray-100 transition">
                <i class="fas fa-search mr-2"></i>Parcourir les missions
            </a>
        </div>

        <p class="text-gray-400 text-sm mt-8">
            <i class="fas fa-lock mr-1"></i> Inscription 100% gratuite ‚Ä¢ Sans engagement ‚Ä¢ Validation en 48h
        </p>
    </div>
</section>

<?php include get_template_directory() . "/footer-content.php"; ?>
<?php wp_footer(); ?>
</body>

</html>--- FILE: theme/page-profil-opticien.php ---
<?php
/*
Template Name: Profil Opticien Public
*/
include 'header-inc.php';
?>

<div class="min-h-screen bg-gray-50 pt-28 pb-16">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Loading State -->
        <div id="loading-state" class="text-center py-20">
            <i class="fas fa-circle-notch fa-spin text-4xl text-oblink-blue mb-4"></i>
            <p class="text-gray-500">Chargement du profil...</p>
        </div>

        <!-- Profile Content (Hidden until loaded) -->
        <div id="profile-content" class="hidden">

            <!-- Main Card -->
            <div class="bg-white rounded-3xl shadow-lg overflow-hidden border border-gray-100">

                <!-- Header Banner -->
                <div class="h-32 bg-gradient-to-r from-oblink-blue to-oblink-violet relative">
                    <div class="absolute -bottom-12 left-8">
                        <div id="profile-avatar"
                            class="w-24 h-24 rounded-2xl bg-white border-4 border-white shadow-lg flex items-center justify-center text-3xl font-bold text-oblink-gray">
                            <!-- Initials or Avatar -->
                        </div>
                    </div>
                </div>

                <!-- Profile Info -->
                <div class="pt-16 px-8 pb-8">
                    <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4 mb-6">
                        <div>
                            <h1 id="profile-name" class="text-2xl font-bold text-gray-900 mb-1">Chargement...</h1>
                            <p id="profile-location" class="text-gray-500 flex items-center gap-2">
                                <i class="fas fa-map-marker-alt text-oblink-orange"></i>
                                <span>Ville</span>
                            </p>
                        </div>
                        <div class="flex gap-3">
                            <span id="profile-status"
                                class="px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-bold">
                                <i class="fas fa-circle text-xs mr-1"></i> Disponible
                            </span>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="grid grid-cols-3 gap-4 mb-8 p-4 bg-gray-50 rounded-2xl">
                        <div class="text-center">
                            <div id="profile-rate" class="text-2xl font-bold text-oblink-orange">--</div>
                            <div class="text-xs text-gray-500">‚Ç¨ / heure</div>
                        </div>
                        <div class="text-center border-x border-gray-200">
                            <div id="profile-experience" class="text-2xl font-bold text-oblink-blue">--</div>
                            <div class="text-xs text-gray-500">Exp√©rience</div>
                        </div>
                        <div class="text-center">
                            <div id="profile-mobility" class="text-2xl font-bold text-oblink-violet">--</div>
                            <div class="text-xs text-gray-500">km mobilit√©</div>
                        </div>
                    </div>

                    <!-- Bio -->
                    <div class="mb-8">
                        <h2 class="text-lg font-bold text-gray-900 mb-3">√Ä propos</h2>
                        <p id="profile-bio" class="text-gray-600 leading-relaxed">
                            Aucune bio renseign√©e.
                        </p>
                    </div>

                    <!-- Skills -->
                    <div class="mb-8">
                        <h2 class="text-lg font-bold text-gray-900 mb-3">Comp√©tences</h2>
                        <div id="profile-skills" class="flex flex-wrap gap-2">
                            <!-- Skills tags -->
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-100">
                        <button id="contact-btn"
                            class="flex-1 px-6 py-3 bg-oblink-blue text-white font-bold rounded-xl hover:bg-blue-600 transition shadow-lg shadow-blue-200 flex items-center justify-center gap-2">
                            <i class="fas fa-envelope"></i> Contacter
                        </button>
                        <a href="<?php echo home_url('/recherche-opticiens'); ?>"
                            class="px-6 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition flex items-center justify-center gap-2">
                            <i class="fas fa-arrow-left"></i> Retour √† la carte
                        </a>
                    </div>
                </div>
            </div>

        </div>

        <!-- Error State -->
        <div id="error-state" class="hidden text-center py-20">
            <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl">üòï
            </div>
            <h2 class="text-xl font-bold text-gray-900 mb-2">Profil introuvable</h2>
            <p class="text-gray-500 mb-6">Cet opticien n'existe pas ou son profil est priv√©.</p>
            <a href="<?php echo home_url('/recherche-opticiens'); ?>"
                class="px-6 py-3 bg-oblink-blue text-white font-bold rounded-xl hover:bg-blue-600 transition inline-block">
                Retour √† la recherche
            </a>
        </div>

    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const loadingState = document.getElementById('loading-state');
        const profileContent = document.getElementById('profile-content');
        const errorState = document.getElementById('error-state');

        // Get ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const profileId = urlParams.get('id');

        if (!profileId) {
            loadingState.classList.add('hidden');
            errorState.classList.remove('hidden');
            return;
        }

        try {
            // Fetch Profile from Supabase
            const { data: profile, error } = await window.oblinkSupabase
                .from('profiles')
                .select('*')
                .eq('id', profileId)
                .eq('user_type', 'opticien')
                .single();

            if (error || !profile) throw new Error('Profile not found');

            // Populate UI
            document.getElementById('profile-name').textContent = `${profile.first_name || ''} ${profile.last_name || ''}`.trim() || 'Opticien';
            document.getElementById('profile-location').querySelector('span').textContent = profile.city || 'France';
            document.getElementById('profile-bio').textContent = profile.bio || profile.bio_short || 'Aucune bio renseign√©e.';
            document.getElementById('profile-rate').textContent = profile.hourly_rate || '--';
            document.getElementById('profile-experience').textContent = formatExperience(profile.experience);
            document.getElementById('profile-mobility').textContent = profile.mobility_km || '30';

            // Avatar
            const avatar = document.getElementById('profile-avatar');
            if (profile.avatar_url) {
                avatar.innerHTML = `<img src="${profile.avatar_url}" class="w-full h-full object-cover rounded-2xl" alt="Avatar">`;
            } else {
                const initials = (profile.first_name?.charAt(0) || '') + (profile.last_name?.charAt(0) || '');
                avatar.textContent = initials || 'O';
            }

            // Status
            const statusEl = document.getElementById('profile-status');
            if (profile.available) {
                statusEl.className = 'px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-bold';
                statusEl.innerHTML = '<i class="fas fa-circle text-xs mr-1"></i> Disponible';
            } else {
                statusEl.className = 'px-4 py-2 bg-gray-100 text-gray-600 rounded-full text-sm font-bold';
                statusEl.innerHTML = '<i class="fas fa-circle text-xs mr-1"></i> Occup√©';
            }

            // Skills
            const skillsContainer = document.getElementById('profile-skills');
            const skills = profile.skills || [];
            if (skills.length > 0) {
                skillsContainer.innerHTML = skills.map(skill =>
                    `<span class="px-3 py-1.5 bg-oblink-blue/10 text-oblink-blue rounded-full text-sm font-medium">${formatSkill(skill)}</span>`
                ).join('');
            } else {
                skillsContainer.innerHTML = '<span class="text-gray-400 text-sm">Aucune comp√©tence renseign√©e</span>';
            }

            // Contact Button
            document.getElementById('contact-btn').addEventListener('click', async () => {
                // Check if logged in
                const { data: { session } } = await window.oblinkSupabase.auth.getSession();
                if (!session) {
                    alert('Connectez-vous pour contacter cet opticien.');
                    window.location.href = '<?php echo home_url("/login"); ?>';
                    return;
                }
                // Open messaging modal if exists, or redirect to messaging
                if (typeof openContactModal === 'function') {
                    openContactModal(profileId, `${profile.first_name} ${profile.last_name}`);
                } else {
                    alert('Fonctionnalit√© de messagerie en cours de d√©veloppement.');
                }
            });

            // Show Content
            loadingState.classList.add('hidden');
            profileContent.classList.remove('hidden');

        } catch (err) {
            console.error('Error loading profile:', err);
            loadingState.classList.add('hidden');
            errorState.classList.remove('hidden');
        }

        // Helpers
        function formatExperience(exp) {
            const map = {
                'junior': '0-2 ans',
                'confirme': '3-5 ans',
                'senior': '5-10 ans',
                'expert': '10+ ans'
            };
            return map[exp] || exp || '--';
        }

        function formatSkill(skill) {
            const map = {
                'contactologie': 'Contactologie',
                'basse_vision': 'Basse Vision',
                'pediatrie': 'P√©diatrie',
                'optometrie': 'Optom√©trie',
                'vente': 'Vente',
                'atelier': 'Atelier',
                'luxe': 'Luxe',
                'sport': 'Optique Sport',
                'management': 'Management'
            };
            return map[skill] || skill;
        }
    });
</script>

<?php
include get_template_directory() . "/footer-content.php";
wp_footer();
?>--- FILE: theme/page-simulateur.php ---
<?php
/*
Template Name: Page Simulateur v3 - Advanced
*/
include 'header-inc.php';
require_once get_template_directory() . '/inc/simulator-email.php';
?>


<!-- Simulator Hero -->
<div
    class="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-oblink-orange/5 to-transparent skew-x-12 transform pointer-events-none">
</div>
<div class="absolute bottom-0 left-0 w-64 h-64 bg-oblink-violet/5 rounded-full filter blur-3xl pointer-events-none">
</div>

<div class="max-w-6xl mx-auto px-4 relative z-10">

    <!-- Header Section -->
    <div class="text-center mb-12">
        <span
            class="inline-block py-1 px-3 rounded-full bg-oblink-orange/10 text-oblink-orange font-bold text-sm mb-4 uppercase tracking-wider">
            Simulateur Opticien
        </span>
        <h1 class="text-4xl md:text-6xl font-black font-display text-oblink-gray mb-6">
            Calculez votre <span
                class="bg-gradient-to-r from-oblink-orange to-oblink-violet bg-clip-text text-transparent">net
                r√©el</span>
        </h1>
        <p class="text-xl text-oblink-gray/70 max-w-2xl mx-auto font-body">
            Mission freelance ou salaire en contrat : d√©couvrez combien vous toucherez r√©ellement.
        </p>
    </div>

    <!-- Mode Toggle -->
    <div class="flex justify-center mb-8">
        <div class="inline-flex rounded-xl bg-white p-1 shadow-lg border border-gray-100">
            <button id="mode-freelance" class="mode-toggle-btn active px-6 py-3 rounded-lg font-bold transition-all">
                <i class="fas fa-briefcase mr-2"></i>
                Freelance
            </button>
            <button id="mode-contrat" class="mode-toggle-btn px-6 py-3 rounded-lg font-bold transition-all">
                <i class="fas fa-file-contract mr-2"></i>
                Contrat/Salari√©
            </button>
        </div>
    </div>

    <!-- Simulator Container -->
    <div class="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-white/50 backdrop-blur-xl md:flex min-h-[600px]"
        id="simulator-app">

        <!-- Left Panel: Inputs -->
        <div class="w-full md:w-1/2 p-8 md:p-12 border-r border-gray-100">
            <h2 class="text-2xl font-bold font-display text-oblink-gray mb-8 flex items-center gap-3">
                <span
                    class="flex items-center justify-center w-10 h-10 rounded-full bg-oblink-orange text-white text-lg">1</span>
                <span id="panel-title">Param√®tres Mission</span>
            </h2>

            <!-- Freelance Inputs -->
            <div id="freelance-inputs">
                <div class="mb-10 relative">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Taux Journalier (TJM)
                    </label>
                    <div class="flex items-center gap-4 mb-2">
                        <span class="text-3xl font-black text-oblink-orange" id="tjm-display">350 ‚Ç¨</span>
                    </div>
                    <input type="range" id="tjm-slider" min="200" max="800" step="10" value="350"
                        class="w-full h-4 bg-gray-200 rounded-full appearance-none cursor-pointer range-slider accent-oblink-orange">
                    <div class="flex justify-between text-xs text-gray-400 mt-2 font-body">
                        <span>200‚Ç¨</span>
                        <span>800‚Ç¨</span>
                    </div>
                </div>

                <div class="mb-10 relative">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Dur√©e de la mission (Jours)
                    </label>
                    <div class="flex items-center gap-4 mb-2">
                        <span class="text-3xl font-black text-oblink-blue" id="days-display">5</span>
                        <span class="text-sm text-gray-500 font-medium">jours</span>
                    </div>
                    <input type="range" id="days-slider" min="1" max="30" step="1" value="5"
                        class="w-full h-4 bg-gray-200 rounded-full appearance-none cursor-pointer range-slider-blue accent-oblink-blue">
                    <div class="flex justify-between text-xs text-gray-400 mt-2 font-body">
                        <span>1 jour</span>
                        <span>1 mois (30j)</span>
                    </div>
                </div>

                <div class="mb-8">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Statut Juridique
                    </label>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="status-btn active group" data-status="micro">
                            <span class="block font-bold">Micro-Ent.</span>
                            <span class="text-xs opacity-70">Rempla√ßant ponctuel</span>
                        </button>
                        <button class="status-btn group" data-status="eurl">
                            <span class="block font-bold">Soci√©t√© (EURL)</span>
                            <span class="text-xs opacity-70">Rempla√ßant r√©gulier</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Contrat Inputs -->
            <div id="contrat-inputs" class="hidden">
                <div class="mb-10 relative">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Salaire Brut Mensuel
                    </label>
                    <div class="flex items-center gap-4 mb-2">
                        <span class="text-3xl font-black text-oblink-orange" id="salaire-display">2500 ‚Ç¨</span>
                    </div>
                    <input type="range" id="salaire-slider" min="1500" max="5000" step="50" value="2500"
                        class="w-full h-4 bg-gray-200 rounded-full appearance-none cursor-pointer range-slider accent-oblink-orange">
                    <div class="flex justify-between text-xs text-gray-400 mt-2 font-body">
                        <span>1500‚Ç¨</span>
                        <span>5000‚Ç¨</span>
                    </div>
                </div>

                <!-- Cadre / Non-Cadre -->
                <div class="mb-8">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Statut
                    </label>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="cadre-btn group" data-cadre="false">
                            <span class="block font-bold">Non-Cadre</span>
                            <span class="text-xs opacity-70">~22% charges</span>
                        </button>
                        <button class="cadre-btn active group" data-cadre="true">
                            <span class="block font-bold">Cadre</span>
                            <span class="text-xs opacity-70">~25% charges</span>
                        </button>
                    </div>
                </div>

                <!-- Heures/semaine -->
                <div class="mb-8">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Temps de travail
                    </label>
                    <div class="grid grid-cols-3 gap-2">
                        <button class="heures-btn active group" data-heures="35">
                            <span class="block font-bold">35h</span>
                            <span class="text-xs opacity-70">Temps plein</span>
                        </button>
                        <button class="heures-btn group" data-heures="39">
                            <span class="block font-bold">39h</span>
                            <span class="text-xs opacity-70">Heures sup</span>
                        </button>
                        <button class="heures-btn group" data-heures="forfait">
                            <span class="block font-bold">Forfait</span>
                            <span class="text-xs opacity-70">Cadre</span>
                        </button>
                    </div>
                </div>

                <!-- Vue Entreprise Toggle -->
                <div class="mb-8">
                    <label class="flex items-center gap-3 cursor-pointer">
                        <input type="checkbox" id="vue-entreprise"
                            class="w-5 h-5 text-oblink-orange rounded focus:ring-oblink-orange">
                        <span class="text-sm font-bold text-oblink-gray">
                            üëî Vue Entreprise (Co√ªt employeur)
                        </span>
                    </label>
                </div>

                <!-- Type Contrat -->
                <div class="mb-8">
                    <label class="block text-sm font-bold text-oblink-gray mb-4 uppercase tracking-wide">
                        Type de Contrat
                    </label>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="contrat-btn active group" data-type="cdd">
                            <span class="block font-bold">CDD</span>
                            <span class="text-xs opacity-70">Dur√©e d√©termin√©e</span>
                        </button>
                        <button class="contrat-btn group" data-type="cdi">
                            <span class="block font-bold">CDI</span>
                            <span class="text-xs opacity-70">Ind√©termin√©e</span>
                        </button>
                    </div>
                </div>
            </div>

            <button id="calculate-btn"
                class="w-full py-4 bg-gradient-to-r from-oblink-orange to-oblink-violet text-white font-black text-lg rounded-xl shadow-lg hover:shadow-2xl hover:scale-[1.02] transition-all transform flex items-center justify-center gap-2">
                <span id="btn-text">Calculer mon Net</span>
                <i class="fas fa-calculator"></i>
            </button>
        </div>

        <!-- Right Panel: Results -->
        <div
            class="w-full md:w-1/2 bg-oblink-gray text-white p-8 md:p-12 flex flex-col justify-center relative overflow-hidden">
            <div class="absolute top-10 right-10 w-32 h-32 bg-oblink-orange rounded-full filter blur-[80px] opacity-20">
            </div>
            <div
                class="absolute bottom-10 left-10 w-40 h-40 bg-oblink-blue rounded-full filter blur-[100px] opacity-20">
            </div>

            <h2 class="text-2xl font-bold font-display mb-8 text-center md:text-left text-white/90">
                <span
                    class="w-10 h-10 rounded-full bg-white/10 inline-flex items-center justify-center mr-2 text-sm backdrop-blur">2</span>
                Vos R√©sultats
            </h2>

            <!-- Email Gate -->
            <div id="email-gate" class="hidden mb-6">
                <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/20">
                    <p class="text-center text-white font-bold mb-4">
                        <i class="fas fa-lock mr-2"></i>
                        Entrez votre email pour voir vos r√©sultats
                    </p>
                    <input type="email" id="user-email" placeholder="votre.email@exemple.com"
                        class="w-full px-4 py-3 rounded-lg bg-white/90 text-oblink-gray font-medium placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-oblink-orange mb-3">
                    <button id="reveal-btn"
                        class="w-full py-3 bg-oblink-orange text-white font-bold rounded-lg hover:bg-oblink-orange/90 transition">
                        D√©voiler les R√©sultats üîì
                    </button>
                    <p class="text-xs text-white/50 text-center mt-2">
                        Vous recevrez aussi vos r√©sultats par email
                    </p>
                </div>
            </div>

            <!-- Results Container -->
            <div id="results-container">
                <div class="glass-dark rounded-3xl p-8 mb-8 text-center border border-white/10 shadow-2xl transform transition-all duration-500"
                    id="result-card">
                    <p class="text-oblink-orange font-bold uppercase tracking-widest text-sm mb-2">Net dans votre poche
                    </p>
                    <div class="text-6xl md:text-7xl font-black font-display mb-2 tracking-tight text-white"
                        id="net-monthly">-- ‚Ç¨</div>
                    <p class="text-white/50 text-sm" id="result-subtitle">Calculez pour voir</p>
                </div>

                <!-- Details Grid -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                        <p class="text-xs uppercase text-gray-400 font-bold mb-1" id="label-1">Total Factur√©</p>
                        <p class="text-xl font-bold font-display" id="gross-value">-- ‚Ç¨</p>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                        <p class="text-xs uppercase text-gray-400 font-bold mb-1">Charges</p>
                        <p class="text-xl font-bold font-display text-red-400" id="total-charges">-- ‚Ç¨</p>
                    </div>
                </div>

                <!-- Taux Horaires (Hidden for Freelance, shown for Contrat) -->
                <div id="taux-horaires" class="hidden mb-6">
                    <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                        <p class="text-xs uppercase text-gray-400 font-bold mb-2">Taux Horaires</p>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm">Brut/heure</span>
                            <span class="font-bold" id="taux-brut-h">-- ‚Ç¨</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm">Net/heure</span>
                            <span class="font-bold text-oblink-orange" id="taux-net-h">-- ‚Ç¨</span>
                        </div>
                    </div>
                </div>

                <!-- Co√ªt Employeur (Hidden unless vue entreprise) -->
                <div id="cout-employeur" class="hidden mb-6">
                    <div class="bg-white/10 p-4 rounded-xl border border-white/20">
                        <p class="text-xs uppercase text-gray-400 font-bold mb-2">üëî Co√ªt Total Employeur</p>
                        <div class="text-3xl font-black text-white mb-1" id="cout-total">-- ‚Ç¨</div>
                        <p class="text-xs text-white/60">Charges patronales incluses (+42%)</p>
                    </div>
                </div>

                <!-- CTA Results -->
                <div class="mt-auto">
                    <p class="text-center text-white/60 text-sm mb-4">Int√©ress√© par ce revenu ?</p>
                    <a href="<?php echo home_url('/inscription-opticien'); ?>"
                        class="w-full py-3 bg-white text-oblink-gray font-bold rounded-xl hover:bg-oblink-orange-claire hover:text-oblink-orange transition-colors flex items-center justify-center gap-2">
                        <i class="fas fa-user-plus"></i>
                        M'inscrire comme Opticien
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
</section>

<style>
    .range-slider {
        -webkit-appearance: none;
        height: 12px;
        background: #EAEBC4;
        border-radius: 10px;
        outline: none;
    }

    .range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: #FF6600;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(255, 102, 0, 0.4);
        border: 4px solid white;
        transition: transform 0.1s;
    }

    .range-slider::-webkit-slider-thumb:hover {
        transform: scale(1.1);
    }

    .range-slider-blue::-webkit-slider-thumb {
        background: #0099FF;
        box-shadow: 0 4px 10px rgba(0, 153, 255, 0.4);
    }

    .status-btn,
    .contrat-btn,
    .cadre-btn,
    .heures-btn,
    .mode-toggle-btn {
        padding: 1rem;
        border-radius: 1rem;
        border: 2px solid #f3f4f6;
        background: white;
        text-align: left;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        color: #303030;
    }

    .heures-btn {
        padding: 0.75rem 0.5rem;
        text-align: center;
    }

    .mode-toggle-btn {
        border: none;
        color: #9CA3AF;
    }

    .mode-toggle-btn.active {
        background: #FF6600;
        color: white;
        box-shadow: 0 4px 15px rgba(255, 102, 0, 0.3);
    }

    .status-btn:hover,
    .contrat-btn:hover,
    .cadre-btn:hover,
    .heures-btn:hover {
        border-color: #EAEBC4;
        background: #FFF7ed;
        transform: translateY(-2px);
    }

    .status-btn.active,
    .contrat-btn.active,
    .cadre-btn.active,
    .heures-btn.active {
        border-color: #FF6600;
        background: #FFF7ed;
        box-shadow: 0 4px 15px rgba(255, 102, 0, 0.15);
        color: #FF6600;
    }

    .blur-results {
        filter: blur(8px);
        pointer-events: none;
        user-select: none;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Elements
        const modeFreelance = document.getElementById('mode-freelance');
        const modeContrat = document.getElementById('mode-contrat');
        const freelanceInputs = document.getElementById('freelance-inputs');
        const contratInputs = document.getElementById('contrat-inputs');
        const panelTitle = document.getElementById('panel-title');
        const calculateBtn = document.getElementById('calculate-btn');
        const btnText = document.getElementById('btn-text');
        const emailGate = document.getElementById('email-gate');
        const resultsContainer = document.getElementById('results-container');
        const revealBtn = document.getElementById('reveal-btn');
        const userEmailInput = document.getElementById('user-email');

        // Freelance
        const tjmSlider = document.getElementById('tjm-slider');
        const tjmDisplay = document.getElementById('tjm-display');
        const daysSlider = document.getElementById('days-slider');
        const daysDisplay = document.getElementById('days-display');
        const statusBtns = document.querySelectorAll('.status-btn');

        // Contrat
        const salaireSlider = document.getElementById('salaire-slider');
        const salaireDisplay = document.getElementById('salaire-display');
        const contratBtns = document.querySelectorAll('.contrat-btn');
        const cadreBtns = document.querySelectorAll('.cadre-btn');
        const heuresBtns = document.querySelectorAll('.heures-btn');
        const vueEntrepriseCheckbox = document.getElementById('vue-entreprise');

        // Results
        const netMonthly = document.getElementById('net-monthly');
        const grossValue = document.getElementById('gross-value');
        const totalCharges = document.getElementById('total-charges');
        const resultSubtitle = document.getElementById('result-subtitle');
        const label1 = document.getElementById('label-1');
        const tauxHoraires = document.getElementById('taux-horaires');
        const tauxBrutH = document.getElementById('taux-brut-h');
        const tauxNetH = document.getElementById('taux-net-h');
        const coutEmployeur = document.getElementById('cout-employeur');
        const coutTotal = document.getElementById('cout-total');

        let currentMode = 'freelance';
        let currentStatus = 'micro';
        let currentContrat = 'cdd';
        let currentCadre = true;
        let currentHeures = 35;
        let vueEntreprise = false;
        let calculatedResults = null;
        let hasCalculated = false;
        let emailSubmitted = false;

        // Mode Toggle
        modeFreelance.addEventListener('click', () => switchMode('freelance'));
        modeContrat.addEventListener('click', () => switchMode('contrat'));

        function switchMode(mode) {
            currentMode = mode;

            if (mode === 'freelance') {
                modeFreelance.classList.add('active');
                modeContrat.classList.remove('active');
                freelanceInputs.classList.remove('hidden');
                contratInputs.classList.add('hidden');
                panelTitle.textContent = 'Param√®tres Mission';
                label1.textContent = 'Total Factur√© (HT)';
                tauxHoraires.classList.add('hidden');
                coutEmployeur.classList.add('hidden');
            } else {
                modeContrat.classList.add('active');
                modeFreelance.classList.remove('active');
                contratInputs.classList.remove('hidden');
                freelanceInputs.classList.add('hidden');
                panelTitle.textContent = 'Param√®tres Salaire';
                label1.textContent = 'Salaire Brut';
                tauxHoraires.classList.remove('hidden');
            }

            resetResults();
            hasCalculated = false;
            emailSubmitted = false;
        }

        // Freelance listeners
        tjmSlider.addEventListener('input', function () {
            tjmDisplay.textContent = this.value + ' ‚Ç¨';
            if (hasCalculated && !emailSubmitted) calculate(true);
        });

        daysSlider.addEventListener('input', function () {
            daysDisplay.textContent = this.value;
            if (hasCalculated && !emailSubmitted) calculate(true);
        });

        statusBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                statusBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentStatus = this.getAttribute('data-status');
                if (hasCalculated && !emailSubmitted) calculate(true);
            });
        });

        // Contrat listeners
        salaireSlider.addEventListener('input', function () {
            salaireDisplay.textContent = this.value + ' ‚Ç¨';
            if (hasCalculated && !emailSubmitted) calculate(true);
        });

        contratBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                contratBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentContrat = this.getAttribute('data-type');
                if (hasCalculated && !emailSubmitted) calculate(true);
            });
        });

        cadreBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                cadreBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentCadre = this.getAttribute('data-cadre') === 'true';
                if (hasCalculated && !emailSubmitted) calculate(true);
            });
        });

        heuresBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                heuresBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const heures = this.getAttribute('data-heures');
                currentHeures = heures === 'forfait' ? 'forfait' : parseInt(heures);
                if (hasCalculated && !emailSubmitted) calculate(true);
            });
        });

        vueEntrepriseCheckbox.addEventListener('change', function () {
            vueEntreprise = this.checked;
            if (vueEntreprise) {
                coutEmployeur.classList.remove('hidden');
            } else {
                coutEmployeur.classList.add('hidden');
            }
            if (hasCalculated && !emailSubmitted) calculate(true);
        });

        // Calculate Button
        calculateBtn.addEventListener('click', () => {
            if (!hasCalculated) {
                calculate(false);
                hasCalculated = true;
                showEmailGate();
            } else if (!emailSubmitted) {
                showEmailGate();
            }
        });

        // Reveal Button
        revealBtn.addEventListener('click', async () => {
            const email = userEmailInput.value.trim();
            if (!email || !validateEmail(email)) {
                alert('Veuillez entrer une adresse email valide');
                return;
            }

            // Save lead & send email
            await saveLead(email);

            // Reveal results
            emailSubmitted = true;
            emailGate.classList.add('hidden');
            resultsContainer.classList.remove('blur-results');
            btnText.textContent = 'Recalculer';
        });

        function showEmailGate() {
            emailGate.classList.remove('hidden');
            resultsContainer.classList.add('blur-results');
            btnText.textContent = 'Voir les R√©sultats üîì';
        }

        function calculate(silent = false) {
            let results = {};

            if (currentMode === 'freelance') {
                results = calculateFreelance();
            } else {
                results = calculateContrat();
            }

            calculatedResults = results;

            if (!silent) {
                updateDisplay(results);
            } else {
                netMonthly.textContent = Math.floor(results.net).toLocaleString('fr-FR') + ' ‚Ç¨';
                grossValue.textContent = Math.floor(results.gross).toLocaleString('fr-FR') + ' ‚Ç¨';
                totalCharges.textContent = '-' + Math.floor(results.charges).toLocaleString('fr-FR') + ' ‚Ç¨';

                if (currentMode === 'contrat') {
                    tauxBrutH.textContent = results.tauxHoraireBrut.toFixed(2) + ' ‚Ç¨';
                    tauxNetH.textContent = results.tauxHoraireNet.toFixed(2) + ' ‚Ç¨';
                    if (vueEntreprise && results.coutEmployeur) {
                        coutTotal.textContent = Math.floor(results.coutEmployeur).toLocaleString('fr-FR') + ' ‚Ç¨';
                    }
                }
            }
        }

        function calculateFreelance() {
            const tjm = parseInt(tjmSlider.value);
            const days = parseInt(daysSlider.value);
            const ca = tjm * days;

            let rateSocial = currentStatus === 'micro' ? 0.22 : 0.35;
            let rateTax = currentStatus === 'micro' ? 0.02 : 0.05;

            const totalSocial = ca * rateSocial;
            const totalTax = ca * rateTax;
            const totalCost = totalSocial + totalTax;
            const netPocket = ca - totalCost;

            return {
                gross: ca,
                charges: totalCost,
                net: netPocket,
                subtitle: `Pour ${days} jours de travail`
            };
        }

        function calculateContrat() {
            const salaireBrut = parseInt(salaireSlider.value);

            // Charges salariales selon cadre/non-cadre
            const tauxChargesSalariales = currentCadre ? 0.25 : 0.22;
            const chargesSalariales = salaireBrut * tauxChargesSalariales;
            const salaireNet = salaireBrut - chargesSalariales;

            // Imp√¥t simplifi√©
            let tauxImpot = 0.10;
            if (salaireNet > 2000) tauxImpot = 0.12;
            if (salaireNet > 3000) tauxImpot = 0.15;

            const impot = salaireNet * tauxImpot;
            const netApresImpot = salaireNet - impot;

            // Taux horaires
            let heuresMois = currentHeures === 'forfait' ? 151.67 : (currentHeures * 4.33);
            const tauxHoraireBrut = salaireBrut / heuresMois;
            const tauxHoraireNet = netApresImpot / heuresMois;

            // Co√ªt employeur (charges patronales ~42%)
            const chargesPatronales = salaireBrut * 0.42;
            const coutEmployeur = salaireBrut + chargesPatronales;

            return {
                gross: salaireBrut,
                charges: chargesSalariales + impot,
                net: netApresImpot,
                subtitle: 'Net apr√®s imp√¥t (mensuel)',
                tauxHoraireBrut,
                tauxHoraireNet,
                coutEmployeur: vueEntreprise ? coutEmployeur : null
            };
        }

        function updateDisplay(results) {
            animateValue(netMonthly, results.net, ' ‚Ç¨');
            grossValue.textContent = Math.floor(results.gross).toLocaleString('fr-FR') + ' ‚Ç¨';
            totalCharges.textContent = '-' + Math.floor(results.charges).toLocaleString('fr-FR') + ' ‚Ç¨';
            resultSubtitle.textContent = results.subtitle;

            if (currentMode === 'contrat') {
                tauxBrutH.textContent = results.tauxHoraireBrut.toFixed(2) + ' ‚Ç¨';
                tauxNetH.textContent = results.tauxHoraireNet.toFixed(2) + ' ‚Ç¨';

                if (vueEntreprise && results.coutEmployeur) {
                    coutTotal.textContent = Math.floor(results.coutEmployeur).toLocaleString('fr-FR') + ' ‚Ç¨';
                }
            }
        }

        function animateValue(obj, end, suffix) {
            let startTimestamp = null;
            const duration = 500;
            const start = parseFloat(obj.textContent.replace(/[^\d.-]/g, '')) || 0;

            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString('fr-FR') + suffix;
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        function resetResults() {
            netMonthly.textContent = '-- ‚Ç¨';
            grossValue.textContent = '-- ‚Ç¨';
            totalCharges.textContent = '-- ‚Ç¨';
            resultSubtitle.textContent = 'Calculez pour voir';
            emailGate.classList.add('hidden');
            resultsContainer.classList.remove('blur-results');
            btnText.textContent = 'Calculer mon Net';
        }

        function validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        async function saveLead(email) {
            const leadData = {
                email: email,
                type: 'simulateur',
                mode: currentMode,
                data: currentMode === 'freelance'
                    ? { tjm: tjmSlider.value, days: daysSlider.value, status: currentStatus }
                    : { salaire: salaireSlider.value, contrat: currentContrat, cadre: currentCadre, heures: currentHeures },
                resultat: calculatedResults.net,
                created_at: new Date().toISOString()
            };

            // Send to WordPress endpoint to save & email
            try {
                const response = await fetch('<?php echo admin_url('admin-ajax.php'); ?>', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        action: 'save_simulator_lead',
                        email: email,
                        mode: currentMode,
                        data: JSON.stringify(leadData.data),
                        results: JSON.stringify(calculatedResults)
                    })
                });

                const result = await response.json();
                if (result.success) {
                    console.log('Lead saved and email sent!');
                }
            } catch (error) {
                console.error('Error saving lead:', error);
            }
        }
    });
</script>

<?php include get_template_directory() . "/footer-content.php";
wp_footer(); ?>--- FILE: theme/page-observatoire.php ---
<?php
/*
Template Name: Observatoire
*/
include 'header-inc.php';
?>

<div class="min-h-screen bg-gray-50 pt-24 pb-12">

    <!-- Hero Section -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-12">
        <div class="text-center max-w-3xl mx-auto">
            <span class="text-oblink-orange font-bold tracking-wider uppercase text-sm mb-2 block">Market
                Intelligence</span>
            <h1 class="text-4xl md:text-5xl font-bold font-display text-oblink-gray mb-6">Barom√®tre du March√© <span
                    class="text-oblink-blue">2026</span></h1>
            <p class="text-xl text-gray-500 mb-8">Les chiffres cl√©s de l'optique pour n√©gocier vos tarifs et choisir vos
                missions. Donn√©es mises √† jour mensuellement.</p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <a href="#tjm"
                    class="px-6 py-3 bg-white text-oblink-gray font-bold rounded-xl border border-gray-200 hover:border-oblink-blue hover:text-oblink-blue transition">
                    <i class="fas fa-chart-line mr-2"></i>Voir les TJM
                </a>
                <a href="#roi"
                    class="px-6 py-3 bg-oblink-blue text-white font-bold rounded-xl hover:bg-blue-700 transition shadow-lg shadow-blue-500/30">
                    <i class="fas fa-calculator mr-2"></i>Calculateur ROI
                </a>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- TJM Section -->
        <div id="tjm" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <!-- PRIX MOYEN -->
            <div
                class="bg-white rounded-3xl p-8 shadow-lg shadow-gray-200/50 border border-gray-100 relative overflow-hidden">
                <div class="absolute top-0 right-0 p-6 opacity-10">
                    <i class="fas fa-euro-sign text-8xl text-oblink-orange"></i>
                </div>
                <h2 class="text-2xl font-bold font-display text-oblink-gray mb-6">Taux Journalier Moyen (TJM)</h2>

                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="font-bold text-gray-600">√éle-de-France</span>
                            <span class="font-bold text-oblink-orange">380 ‚Ç¨ / jour</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-3">
                            <div class="bg-oblink-orange h-3 rounded-full" style="width: 85%"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-1">Varie de 350‚Ç¨ √† 450‚Ç¨ selon urgence</p>
                    </div>

                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="font-bold text-gray-600">Province (Grandes Villes)</span>
                            <span class="font-bold text-oblink-blue">320 ‚Ç¨ / jour</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-3">
                            <div class="bg-oblink-blue h-3 rounded-full" style="width: 70%"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-1">Lyon, Bordeaux, Nantes... (+ Frais souvent inclus)</p>
                    </div>

                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="font-bold text-gray-600">Zones Rurales</span>
                            <span class="font-bold text-oblink-violet">400 ‚Ç¨ / jour</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-3">
                            <div class="bg-oblink-violet h-3 rounded-full" style="width: 90%"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-1">Prime √† la mobilit√© forte</p>
                    </div>
                </div>
            </div>

            <!-- LOGICIELS -->
            <div class="bg-white rounded-3xl p-8 shadow-lg shadow-gray-200/50 border border-gray-100">
                <h2 class="text-2xl font-bold font-display text-oblink-gray mb-6">Logiciels les plus demand√©s</h2>
                <div class="space-y-4">
                    <div class="flex items-center gap-4">
                        <div class="w-16 text-right font-bold text-gray-400">60%</div>
                        <div
                            class="flex-1 bg-gray-100 rounded-r-xl h-10 flex items-center px-4 relative overflow-hidden group">
                            <div
                                class="absolute left-0 top-0 bottom-0 bg-oblink-gray/10 w-[60%] group-hover:bg-oblink-gray/20 transition">
                            </div>
                            <span class="relative z-10 font-bold text-oblink-gray">Cosium</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-16 text-right font-bold text-gray-400">25%</div>
                        <div
                            class="flex-1 bg-gray-100 rounded-r-xl h-10 flex items-center px-4 relative overflow-hidden group">
                            <div
                                class="absolute left-0 top-0 bottom-0 bg-oblink-blue/10 w-[25%] group-hover:bg-oblink-blue/20 transition">
                            </div>
                            <span class="relative z-10 font-bold text-oblink-gray">Mont√©eristo</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-16 text-right font-bold text-gray-400">10%</div>
                        <div
                            class="flex-1 bg-gray-100 rounded-r-xl h-10 flex items-center px-4 relative overflow-hidden group">
                            <div
                                class="absolute left-0 top-0 bottom-0 bg-oblink-orange/10 w-[10%] group-hover:bg-oblink-orange/20 transition">
                            </div>
                            <span class="relative z-10 font-bold text-oblink-gray">WinOptics</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-16 text-right font-bold text-gray-400">5%</div>
                        <div
                            class="flex-1 bg-gray-100 rounded-r-xl h-10 flex items-center px-4 relative overflow-hidden group">
                            <div
                                class="absolute left-0 top-0 bottom-0 bg-gray-200 w-[5%] group-hover:bg-gray-300 transition">
                            </div>
                            <span class="relative z-10 font-bold text-oblink-gray">Autres</span>
                        </div>
                    </div>
                </div>
                <div class="mt-6 p-4 bg-blue-50 rounded-xl border border-blue-100 flex gap-3 text-sm text-blue-800">
                    <i class="fas fa-lightbulb mt-1"></i>
                    <p><strong>Conseil :</strong> Formez-vous √† Cosium pour acc√©der √† 6 missions sur 10. <a
                            href="<?php echo home_url('/formation-erp'); ?>" class="underline font-bold">Voir la
                            formation.</a></p>
                </div>
            </div>
        </div>

        <!-- ROI Calculator -->
        <div id="roi"
            class="bg-oblink-gray text-white rounded-3xl p-8 lg:p-12 shadow-2xl mb-12 relative overflow-hidden">
            <div
                class="absolute top-0 right-0 w-96 h-96 bg-oblink-orange/20 rounded-full blur-[100px] pointer-events-none">
            </div>

            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl font-bold font-display mb-4">Salari√© vs Freelance ?</h2>
                    <p class="text-gray-400 mb-8">Ne comparez pas des pommes et des poires. Calculez votre "Libert√©
                        Financi√®re" en comparant votre salaire net actuel avec le potentiel freelance.</p>

                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-bold text-gray-400 mb-2">Votre Salaire Net Mensuel
                                (CDI)</label>
                            <div class="relative">
                                <input type="number" id="roi-salary" value="2200"
                                    class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white font-bold focus:outline-none focus:border-oblink-orange transition">
                                <span class="absolute right-4 top-3 text-gray-400">‚Ç¨</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-400 mb-2">Votre TJM Estim√©
                                (Freelance)</label>
                            <div class="relative">
                                <input type="number" id="roi-tjm" value="350"
                                    class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white font-bold focus:outline-none focus:border-oblink-blue transition">
                                <span class="absolute right-4 top-3 text-gray-400">‚Ç¨</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10 text-center">
                    <p class="text-lg font-medium text-gray-300 mb-2">Pour gagner la m√™me chose, vous devez travailler :
                    </p>
                    <div class="flex items-center justify-center gap-2 mb-4">
                        <span id="roi-days" class="text-6xl font-black text-oblink-orange">6.3</span>
                        <span class="text-xl text-left leading-tight font-bold text-gray-400">Jours<br>par mois</span>
                    </div>
                    <p class="text-sm text-gray-400 mb-6">Soit <span class="text-white font-bold"
                            id="roi-rest">15</span> jours de temps libre en plus (ou de gain suppl√©mentaire).</p>

                    <button onclick="window.location.href='<?php echo home_url('/inscription-opticien'); ?>'"
                        class="w-full py-3 bg-white text-oblink-gray font-bold rounded-xl hover:bg-oblink-orange hover:text-white transition">
                        Devenir Freelance
                    </button>
                </div>
            </div>
        </div>

        <!-- Lead Magnet -->
        <div class="bg-gradient-to-r from-oblink-blue to-blue-600 rounded-3xl p-8 lg:p-12 text-white text-center">
            <div class="max-w-2xl mx-auto">
                <i class="fas fa-file-pdf text-4xl mb-4 text-blue-200"></i>
                <h2 class="text-3xl font-bold font-display mb-4">T√©l√©chargez l'√âtude Compl√®te 2026</h2>
                <p class="text-blue-100 mb-8">Acc√©dez aux d√©tails par r√©gion, aux grilles de salaires d√©taill√©es et aux
                    pr√©visions de recrutement des grandes enseignes.</p>

                <form onsubmit="event.preventDefault(); alert('L\'√©tude vous a √©t√© envoy√©e par email !');"
                    class="flex flex-col sm:flex-row gap-4 max-w-lg mx-auto">
                    <input type="email" placeholder="Votre email pro" required
                        class="flex-1 px-4 py-3 rounded-xl text-gray-800 focus:outline-none focus:ring-4 focus:ring-white/30">
                    <button type="submit"
                        class="px-6 py-3 bg-oblink-orange font-bold rounded-xl hover:bg-orange-500 transition shadow-lg">
                        Recevoir le PDF
                    </button>
                </form>
                <p class="text-xs text-blue-200 mt-4"><i class="fas fa-lock mr-1"></i> Vos donn√©es restent
                    confidentielles.</p>
            </div>
        </div>

    </div>
</div>

<script>
    // Simple ROI Logic
    const salaryInput = document.getElementById('roi-salary');
    const tjmInput = document.getElementById('roi-tjm');
    const daysDisplay = document.getElementById('roi-days');
    const restDisplay = document.getElementById('roi-rest');

    function calculateROI() {
        const salary = parseFloat(salaryInput.value) || 0;
        const tjm = parseFloat(tjmInput.value) || 1;

        // Calcul simpliste : Salaire Net / (TJM * 0.76 pour approx charges micro-social/frais) 
        // Ou brut pour brut. 
        // Pour simplifier l'argumentaire freelance : on va dire que le TJM affich√© est ce qui rentre avant imp√¥t, 
        // et le salaire est net. Un Raccourci marketing assum√© pour l'instant, ou on compare Brut vs CA.
        // LE PLUS PARLANT : Combien de jours de facturation pour √©galer le salaire NET ?
        // Hypoth√®se : 25% charges URSSAF en micro. Donc Net = TJM * 0.75.

        const netPerDay = tjm * 0.75;
        const daysNeeded = salary / netPerDay;
        const workingDaysInMonth = 21; // Approx

        daysDisplay.innerText = daysNeeded.toFixed(1);

        const rest = workingDaysInMonth - daysNeeded;
        restDisplay.innerText = rest > 0 ? rest.toFixed(1) : 0;
    }

    salaryInput.addEventListener('input', calculateROI);
    tjmInput.addEventListener('input', calculateROI);

    // Init
    calculateROI();
</script>

<?php
include get_template_directory() . "/footer-content.php";
wp_footer();
?>